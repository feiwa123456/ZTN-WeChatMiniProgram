(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-devicePlayer-devicePlayer"],{"0b74":function(t,e,i){"use strict";function n(t,e,i){var n=t.$uniBaseRequest(t,"/camera/bind/list",{userId:e,deviceCore:i});return n}function a(t,e,i,n){var a=t.$uniBaseRequest(t,"/camera/device/pageGet",{userId:e,currentPage:i,pageSize:n});return a}function s(t,e,i,n){var a=t.$uniBaseRequest(t,"/camera/auth/pageGet",{userId:e,currentPage:i,pageSize:n});return a}function o(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60,n=t.$uniBaseRequest(t,"/camera/device/pushCloud",{mediaType:"rtmp",deviceId:e,pushTime:i});return n}function c(t,e){var i=t.$uniBaseRequest(t,"/camera/device/stopCloud",{deviceId:e});return i}function r(t,e){var i=t.$uniBaseRequest(t,"/camera/device/keepPushCloud",{mediaType:"rtmp",deviceId:e});return i}function u(t,e,i){var n=t.$uniBaseRequest(t,"/camera/device/controlAction",{deviceId:e,action:i});return n}Object.defineProperty(e,"__esModule",{value:!0}),e.getCameraList=n,e.getCameraDeviceList=a,e.getCameraAuthList=s,e.pushCloud=o,e.stopCloud=c,e.keepPushCloud=r,e.sendActionCommand=u},"8d41":function(t,e,i){"use strict";var n=i("dbce");i("99af"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("0b74")),s={data:function(){return{CustomBar:this.CustomBar,isToHome:!1,fromLoginBack:!1,isLogin:!1,isLoginOverdue:!1,videoType:"rtmp",playUrl:"",playerContext:null,direction:"vertical",fullscreenIcon:"../../static/images/cam/full.png",playIcon:"../../static/images/cam/play.png",pauseIcon:"../../static/images/cam/pause.png",isHidden:!1,isPlay:!1,isFull:!1,actionText:"",isShowActionText:!1,deviceId:null,pushTime:60}},computed:{i18n:function(){return this.$i18nMsg()}},onReady:function(){var t=document.createElement("video");t.id="video",t.style="width:100%;height:100%;position:absolute;top:50%;left: 50%;transform: translate(-50%,-50%);",t.autoplay=!0,t.controls=!0;var e=document.createElement("source");e.src=this.playUrl,t.appendChild(e),this.$refs.video.$el.appendChild(t),videojs("video")},onLoad:function(t){var e=uni.getStorageSync("isLogin")||!1;this.initOption=t,this.isLogin=e,e?this.init(t):uni.navigateTo({url:"/pages/login/login"})},onShow:function(){this.$uniUtilsApi.toHome(this);var t=this.initOption,e=this.fromLoginBack;e&&(this.init(t),this.fromLoginBack=!1,this.isLoginOverdue=!1,this.isLogin=!0)},onUnload:function(){var t=this.isLogin,e=this.deviceId;t&&a.stopCloud(this,e).then((function(t){t.code}))},methods:{init:function(t){this.deviceId=t.deviceId,this.pushCloud()},pushCloud:function(){var t=this,e=this.deviceId,i=this.pushTime;a.pushCloud(this,e,i).then((function(e){if("200"==e.code){var i=e.data.playUrl;if(null!=i){var n=e.data.mediaType;t.playUrl=i,t.videoType="m3u8"==n||"httpflv"==n?n:"rtmp",t.isPlay=!0}else t.$uniUtilsApi.showToast(t.i18n.invalidAddress,"none",1e3,!1)}else{if("201"==e.code)switch(e.msg){case"serverCompany":t.$uniUtilsApi.showToast(t.i18n.camera.equipmentNotSupported,"none",1e3,!1);break;case"OFFLINE":t.$uniUtilsApi.showToast(t.i18n.camera.equipmentOffline,"none",1e3,!1);break;default:t.$uniUtilsApi.showToast(t.i18n.camera.pushFailure,"none",1e3,!1);break}else t.$uniUtilsApi.showToast(t.i18n.camera.pushFailure,"none",1e3,!1);setTimeout((function(){uni.navigateBack()}),1e3)}}))},tapAction:function(t){var e=t.currentTarget.id;this.actionText=t.currentTarget.dataset.label,this.sendActionCommand(e)},showActionText:function(){var t=this;this.isShowActionText=!0,setTimeout((function(){t.isShowActionText=!1}),3e3)},sendActionCommand:function(t){var e=this,i=this.deviceId;a.sendActionCommand(this,i,t).then((function(t){"200"==t.code?(e.showActionText(),e.$uniUtilsApi.showToast(e.i18n.commandSentSuccess,"none",1e3,!1)):e.$uniUtilsApi.showToast(e.i18n.commandSentfail,"none",1e3,!1)}))},tapPlay:function(t){var e=this.isPlay;e?this.playerContext.pause():this.playerContext.resume(),this.isPlay=!e},tapFullscreen:function(t){var e=this.isFull;e?this.playerContext.exitFullScreen({}):this.playerContext.requestFullScreen({}),this.isFull=!e},statechange:function(t){},error:function(t){},fullscreenChange:function(t){var e=t.detail.fullScreen;this.direction=e?"horizontal":"vertical"}},onShareAppMessage:function(t){var e=this.deviceId,i=uni.getStorageSync("nickName"),n=uni.getStorageSync("shortCompanyName");return{title:"".concat(i).concat(this.i18n.moreOperate.share).concat(n),path:"/pages/devicePlayer/devicePlayer?deviceId=".concat(e),success:function(t){}}}};e.default=s},"9d5d":function(t,e,i){"use strict";var n;i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[t.isToHome?i("cu-custom",{attrs:{isHome:!0}}):i("cu-custom",{attrs:{isBack:!0}}),i("v-uni-view",{ref:"video",staticClass:"video-js",staticStyle:{position:"fixed",width:"100vw",height:"225px"}}),t.isLogin?i("v-uni-view",{staticClass:"text-center",staticStyle:{"margin-top":"50rpx"}},[t._v(t._s(t.actionText))]):t._e(),t.isLogin?i("v-uni-view",{staticClass:"flex margin-top"},[i("v-uni-view",{staticClass:"flex-sub flex"},[i("v-uni-view",{staticClass:"flex-sub"},[i("v-uni-view",{staticClass:"cu-btn block line-black margin-lr-xs",staticStyle:{"padding-left":"14px","padding-right":"14x"},attrs:{id:"zoomOut",type:"default","data-label":"聚焦远"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.tapAction.apply(void 0,arguments)}}},[t._v(t._s(t.i18n.camera.focusFar))])],1),i("v-uni-view",{staticClass:"flex-sub"},[i("v-uni-view",{staticClass:"cu-btn block line-black margin-lr-xs ",staticStyle:{"padding-left":"14px","padding-right":"14px"},attrs:{id:"zoomIn",type:"default","data-label":"聚焦近"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.tapAction.apply(void 0,arguments)}}},[t._v(t._s(t.i18n.camera.focusClose))])],1)],1),i("v-uni-view",{staticClass:"flex-sub flex justify-center"},[i("v-uni-view",{staticStyle:{width:"240rpx",height:"240rpx","border-radius":"50%",border:"1px solid #333333"}},[i("v-uni-view",{staticClass:"flex align-center justify-center",staticStyle:{width:"240rpx",height:"80rpx"}},[i("v-uni-view",{staticClass:"cuIcon-fold text-xxl text-bold",attrs:{id:"ptzUp","data-label":"向上"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.tapAction.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"flex align-center justify-between",staticStyle:{width:"240rpx",height:"80rpx"}},[i("v-uni-view",{staticClass:"cuIcon-back text-xxl text-center",staticStyle:{width:"80rpx",height:"80rpx","line-height":"80rpx"},attrs:{id:"ptzLeft","data-label":"向左"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.tapAction.apply(void 0,arguments)}}}),i("v-uni-view",{staticStyle:{"border-radius":"50%",height:"80rpx",width:"80rpx",border:"1px solid #333333"}}),i("v-uni-view",{staticClass:"cuIcon-right text-xxl text-center",staticStyle:{width:"80rpx",height:"80rpx","line-height":"80rpx"},attrs:{id:"ptzRight","data-label":"向右"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.tapAction.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"flex align-center justify-center",staticStyle:{width:"240rpx",height:"80rpx"}},[i("v-uni-view",{staticClass:"cuIcon-unfold text-xxl text-bold",attrs:{id:"ptzDown","data-label":"向下"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.tapAction.apply(void 0,arguments)}}})],1)],1)],1)],1):t._e()],1)},s=[]},a36a:function(t,e,i){"use strict";i.r(e);var n=i("9d5d"),a=i("cd4a");for(var s in a)"default"!==s&&function(t){i.d(e,t,(function(){return a[t]}))}(s);var o,c=i("f0c5"),r=Object(c["a"])(a["default"],n["b"],n["c"],!1,null,"4c9fdf06",null,!1,n["a"],o);e["default"]=r.exports},cd4a:function(t,e,i){"use strict";i.r(e);var n=i("8d41"),a=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=a.a}}]);