(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-deviceLocal-deviceLocal"],{1893:function(t,e,i){"use strict";i.r(e);var a=i("dbb0"),n=i.n(a);for(var o in a)"default"!==o&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=n.a},"273a":function(t,e,i){"use strict";var a;i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return a}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{},[t.isToHome?i("cu-custom",{attrs:{isHome:!0}},[i("template",{staticClass:"text-white",style:[{color:t.navigationBarTextColor}],attrs:{slot:"homeText"},slot:"homeText"},[t._v(t._s(t.deviceName))])],2):i("cu-custom",{attrs:{isBack:!0}},[i("template",{staticClass:"text-white",style:[{color:t.navigationBarTextColor}],attrs:{slot:"backText"},slot:"backText"},[t._v(t._s(t.deviceName))])],2),t.isShowMap?i("v-uni-map",{staticStyle:{width:"100%",height:"400upx"},attrs:{id:"myMap",scale:t.scale,longitude:t.longitude,latitude:t.latitude,markers:t.markers}}):t._e(),i("v-uni-scroll-view",{style:t.scrollStyle,attrs:{"scroll-y":"true"}},t._l(t.deviceLocalList,(function(e,a){return i("v-uni-view",{key:a,staticClass:"cu-timeline"},["OFFLINE"==e.status?i("v-uni-view",{staticClass:"cu-time"},[t._v(t._s(t.i18n.precision)+":"+t._s(e.radius))]):t._e(),i("v-uni-view",{staticClass:"cu-item cuIcon-attentionfill",style:[{color:t.lightColor}]},[i("v-uni-view",{staticClass:"content",staticStyle:{"background-color":"#f8f8f8"}},[i("v-uni-view",{staticClass:"flex justify-between align-center"},[i("v-uni-view",{staticStyle:{"flex-basis":"90%"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.tapMarker(e)}}},[i("v-uni-view",[i("v-uni-text",{staticClass:"text-gray"},[t._v(t._s(t.i18n.serial)+":"+t._s(a+1))]),i("v-uni-text",{staticClass:"text-gray margin-left"},[t._v(t._s(t._f("formatDateTime")(e.timestamp,t.i18n.unknown)))])],1),i("v-uni-view",{staticStyle:{color:"#666666"}},[t._v(t._s(e.address))])],1),i("v-uni-view",{on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.navigation(e)}}},[i("v-uni-text",{staticClass:"cuIcon-footprint",staticStyle:{"font-size":"44upx"},style:[{color:t.emphasizeColor}]})],1)],1)],1)],1)],1)})),1),i("v-uni-view",{staticClass:"cu-modal",class:[t.isShowAuthorizeModal?"show":""]},[i("v-uni-view",{staticClass:"cu-dialog"},[i("v-uni-view",{staticClass:"cu-bar bg-white justify-end"},[i("v-uni-view",{staticClass:"content"},[t._v(t._s(t.i18n.authorize))]),i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideAuthorizeModal.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-close text-red"})],1)],1),i("v-uni-view",{staticClass:"padding-xl"},[t._v(t._s(t.i18n.leadGoAuthorize))]),i("v-uni-view",{staticClass:"cu-bar bg-white justify-end"},[i("v-uni-view",{staticClass:"action"},[i("v-uni-button",{staticClass:"cu-btn line-green text-green",style:[{borderColor:t.emphasizeColor,color:t.emphasizeColor}],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideAuthorizeModal.apply(void 0,arguments)}}},[t._v(t._s(t.i18n.cancel))]),i("v-uni-button",{staticClass:"cu-btn bg-green margin-left",style:[{backgroundColor:t.emphasizeColor}],attrs:{"open-type":"openSetting"},on:{opensetting:function(e){arguments[0]=e=t.$handleEvent(e),t.authorizeManage.apply(void 0,arguments)}}},[t._v(t._s(t.i18n.confirm))])],1)],1)],1)],1)],1)},o=[]},"57c0":function(t,e,i){"use strict";i.r(e);var a=i("273a"),n=i("1893");for(var o in n)"default"!==o&&function(t){i.d(e,t,(function(){return n[t]}))}(o);var s,c=i("f0c5"),l=Object(c["a"])(n["default"],a["b"],a["c"],!1,null,"4afcfc5d",null,!1,a["a"],s);e["default"]=l.exports},"5c69":function(t,e,i){"use strict";function a(t,e,i,a){var n=t.$uniBaseRequest(t,"/device/local/pageGet",{deviceCore:e,currentPage:i,pageSize:a});return n}Object.defineProperty(e,"__esModule",{value:!0}),e.getDeviceLocal=a},dbb0:function(t,e,i){"use strict";var a=i("dbce");i("99af"),i("a9e3"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("5c69")),o={data:function(){return{CustomBar:this.CustomBar,isToHome:!1,fromLoginBack:!1,isLoginOverdue:!1,navigationBarTextColor:"",emphasizeColor:"",lightColor:"",scrollStyle:"",isShowMap:!1,scale:8,longitude:"",latitude:"",markers:[],deviceLocalList:[],deviceName:"",deviceCore:"",currentPage:1,pageSize:50,isShowAuthorizeModal:!1,navigationItem:null}},computed:{i18n:function(){return this.$i18nMsg()},themei18n:function(){return this.$themei18nOption()}},onReady:function(){this.navigationBarTextColor=this.themei18n.navigationBarTextColor;var t,e=this.themei18n.theme;switch(e){case"default":t="orangeLight";break;case"darkColor":t="blueLight";break;case"lightColor":t="blueLight";break;default:break}this.lightColor=this.themei18n.lightColor[t],this.emphasizeColor=this.themei18n.emphasizeColor},onLoad:function(t){var e=uni.getStorageSync("isLogin")||!1;this.initOption=t,e?this.init(t):uni.navigateTo({url:"/pages/login/login"})},onShow:function(){this.$uniUtilsApi.toHome(this);var t=this.initOption,e=this.fromLoginBack;e&&(this.init(t),this.fromLoginBack=!1,this.isLoginOverdue=!1)},methods:{init:function(t){this.deviceName=t.deviceName,this.deviceCore=t.deviceCore,this.getDeviceLocal()},getDeviceLocal:function(){var t=this,e=this.deviceCore,i=this.currentPage,a=this.pageSize;n.getDeviceLocal(this,e,i,a).then((function(e){if("200"==e.code){var i=e.data.data;if(i.length<1){var a=t.i18n.noData;return t.$uniUtilsApi.showToast(a,"none",1e3,!1),void setTimeout((function(){uni.navigateBack({delta:1})}),1e3)}for(var n=0;n<i.length;n++){var o={},s={},c=Number(i[n].lat),l=Number(i[n].lng);o.width=25,o.height=25,o.latitude=c,o.longitude=l,o.iconPath="../../static/numsImage/local_".concat(n+1,".png"),t.$set(t.markers,n,o),s.timestamp=i[n].timestamp,s.radius=i[n].radius+"ç±³",s.address=i[n].address,s.lat=i[n].lat,s.lng=i[n].lng,t.$set(t.deviceLocalList,n,s)}t.latitude=c,t.longitude=l,t.isShowMap=!0;var r=t.CustomBar,u=uni.getStorageSync("screenHeight"),v=uni.getStorageSync("mapHeight");v?t.scrollStyle="height:calc(".concat(u,"px - ").concat(v,"upx - ").concat(r,"px)"):t.$nextTick((function(){setTimeout((function(){t.scrollStyle="height:calc(".concat(u,"px - 400upx - ").concat(r,"px)"),uni.setStorageSync("mapHeight",400)}),200)}))}}))},tapMarker:function(t){var e=t.lat,i=t.lng;this.latitude=e,this.longitude=i},navigation:function(t){var e=this;this.$uniUtilsApi.showLoading(this.i18n.loading,!0);var i=this.deviceName,a=t.lat,n=t.lng,o=t.address;uni.getLocation({type:"wgs84",success:function(t){e.$uniUtilsApi.hideLoading(),uni.openLocation({latitude:a,longitude:n,name:i,address:o})},fail:function(i){e.$uniUtilsApi.hideLoading(),e.navigationItem=t,e.showAuthorizeModal()}})},showAuthorizeModal:function(){this.isShowAuthorizeModal=!0},hideAuthorizeModal:function(){this.isShowAuthorizeModal=!1},authorizeManage:function(t){var e=t.detail.authSetting;if(e["scope.userLocation"]){var i=this.navigationItem;this.hideAuthorizeModal(),this.navigation(i)}}},onShareAppMessage:function(t){var e=this.deviceName,i=this.deviceCore,a=uni.getStorageSync("nickName");return{title:"".concat(a).concat(this.i18n.moreOperate.share).concat(e),path:"/pages/deviceLocal/deviceLocal?deviceName=".concat(e,"&&deviceCore=").concat(i),success:function(t){}}}};e.default=o}}]);