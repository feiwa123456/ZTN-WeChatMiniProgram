(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-deviceController-deviceController~pages-deviceNavigation-deviceNavigation"],{"0b74":function(t,e,i){"use strict";function a(t,e,i){var a=t.$uniBaseRequest(t,"/camera/bind/list",{userId:e,deviceCore:i});return a}function s(t,e,i,a){var s=t.$uniBaseRequest(t,"/camera/device/pageGet",{userId:e,currentPage:i,pageSize:a});return s}function n(t,e,i,a){var s=t.$uniBaseRequest(t,"/camera/auth/pageGet",{userId:e,currentPage:i,pageSize:a});return s}function o(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60,a=t.$uniBaseRequest(t,"/camera/device/pushCloud",{mediaType:"rtmp",deviceId:e,pushTime:i});return a}function r(t,e){var i=t.$uniBaseRequest(t,"/camera/device/stopCloud",{deviceId:e});return i}function l(t,e){var i=t.$uniBaseRequest(t,"/camera/device/keepPushCloud",{mediaType:"rtmp",deviceId:e});return i}function c(t,e,i){var a=t.$uniBaseRequest(t,"/camera/device/controlAction",{deviceId:e,action:i});return a}Object.defineProperty(e,"__esModule",{value:!0}),e.getCameraList=a,e.getCameraDeviceList=s,e.getCameraAuthList=n,e.pushCloud=o,e.stopCloud=r,e.keepPushCloud=l,e.sendActionCommand=c},2341:function(t,e,i){var a=i("746fa");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var s=i("4f06").default;s("44aca288",a,!0,{sourceMap:!1,shadowMode:!1})},"2a10":function(t,e,i){"use strict";var a=i("dbce"),s=i("4ea4");i("99af"),i("4de4"),i("c975"),i("a15b"),i("d81d"),i("a9e3"),i("d3b7"),i("ac1f"),i("25f0"),i("1276"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;for(var n=s(i("165c")),o=a(i("a549")),r=a(i("f477")),l=a(i("0b74")),c=[],u=[],d=[],v=[],h=0;h<24;h++){var p=h+"";c[h]=p[1]?p:"0"+p}for(var m=0;m<60;m++){var g=m+"";u[m]=g[1]?g:"0"+g}for(var f=0;f<24;f++){var b=f+"";d[f]=b[1]?b:"0"+b}for(var C=0;C<60;C++){var y=C+"";v[C]=y[1]?y:"0"+y}var x={data:function(){return{CustomBar:this.CustomBar,isLogin:!1,isLoginOverdue:!1,navigationBarTextColor:"",showVideo:!1,cameraList:[],cameraListModalStyle:"",showCameraListModal:!1,videoType:"",playUrl:"",playerContext:null,direction:"vertical",isPlay:!1,pushTime:60,playIcon:"../../static/images/cam/play.png",pauseIcon:"../../static/images/cam/pause.png",circleBgColor:"#f8f8f8",style:"",sensorWithSetting:[],multiArray:[c,u,d,v],multiIndex:[0,0,0,0],settingError:"",showErrorModal:!1,emphasizeColor:"",selectButton:"",paddingBottomStyle:"",theme:""}},props:{deviceName:{type:String,default:""},deviceCore:{type:String,default:""},tabbarHeight:{type:[Number,String],default:0},isToHome:{type:Boolean,default:!1}},computed:{i18n:function(){return this.$i18nMsg()},themei18n:function(){return this.$themei18nOption()}},beforeMount:function(){var t,e=this.themei18n.emphasizeColor,i=this.themei18n.theme;switch(this.theme=i,i){case"default":t="orangeLight";break;case"darkColor":t="blueLight";break;case"lightColor":t="blueLight";break;default:break}var a=this.themei18n.lightColor;this.circleBgColor=a[t],this.emphasizeColor=e,this.selectButton="background:${emphasizeColor};color:#fff; border: 1upx solid ${emphasizeColor}"},mounted:function(){var t=uni.getStorageSync("isLogin")||!1;this.isLogin=t,t&&this.init()},methods:{init:function(){this.sensorWithSetting=[],this.cameraList=[],this.getListWith(),this.getCameraList(),this.navigationBarTextColor=this.themei18n.navigationBarTextColor},getListWith:function(){var t=this,e=this.deviceCore,i=!1,a=!1,s=!0;r.getListWith(this,e,i,a,s).then((function(e){if("200"==e.code){var i=e.data.filter((function(t,e){return 0==t.hidden}));if(i.length>0){for(var a=i.filter((function(t,e){return 0!=t.settingList.length})),s=0;s<a.length;s++){var n=a[s].type;a[s].type=t.i18n.deviceSensor.sensorType[n],a[s].settingList=t.getSettingList(a[s].settingList)}t.sensorWithSetting=a}}}))},getSettingList:function(t){for(var e=t.filter((function(t,e,i){return 0==t.hidden})),i=0;i<e.length;i++)if("switch"==e[i].type)e[i].value=1==e[i].value;else if("timeSlot"==e[i].type)if(-1!=e[i].value.indexOf("/")){var a=e[i].value.split(" / "),s=a[0].split(":"),n=a[1].split(":");e[i].multiIndex=s.concat(n),e[i].value=s.map(this.formatNumber).join(":")+" / "+n.map(this.formatNumber).join(":")}else e[i].multiIndex=[0,0,0,0];return e},formatNumber:function(t){return t=t.toString(),t[1]?t:"0"+t},changeParam:function(t){var e=t.currentTarget.dataset,i=e.change,a=e.setting||"",s=e.port||"",n=e.childport||"";switch(i){case"custom":var o=t.detail.value.custom;this.saveSetting(o,a,s,n);break;case"fixed":var r=e.value;this.saveSetting(r,a,s,n);break;case"switch":var l=t.detail.value?"1":"0";this.saveSetting(l,a,s,n);break;case"timeSet":var c=t.detail.value;this.saveSetting(c,a,s,n);break;case"periodTime":var u=t.detail.value,d=this.multiArray[0][u[0]],v=this.multiArray[1][u[1]],h=this.multiArray[2][u[2]],p=this.multiArray[3][u[3]],m=d+":"+v+" / "+h+":"+p;this.saveSetting(m,a,s,n);break;case"nop":this.saveSetting(null,a,s,n);break;case"slider":var g=t.detail.value;this.saveSetting(g,a,s,n);break;default:}},saveSetting:function(t,e,i,a){var s=this;this.$uniUtilsApi.showLoading(this.i18n.loading,!0);var n=this.deviceCore;o.saveSetting(this,n,t,e,i,a).then((function(t){"200"==t.code&&(s.$uniUtilsApi.hideLoading(),s.$uniUtilsApi.showToast(s.i18n.setSuccess,"none",1e3,!0),s.getSettingList())}))},hideErrorModal:function(){this.showErrorModal=!1},getCameraList:function(){var t=this,e=this.deviceCore,i=uni.getStorageSync("userId");l.getCameraList(this,i,e).then((function(e){var i=t.tabbarHeight;"200"==e.code?(t.cameraList=e.data,t.paddingBottomStyle="padding-bottom:calc(".concat(i,"px + 110rpx)")):t.paddingBottomStyle="padding-bottom:".concat(i,"px")}))},openCameraListModal:function(){var t=this.CustomBar;this.cameraListModalStyle="top:".concat(t,"px;height:calc(100vh - {{CustomBar}}px)"),this.showCameraListModal=!0},hideCameraListModal:function(){this.showCameraListModal=!1},tapCamera:function(t){var e=t.deviceId,i=this.pushTime;this.pushCloud(e,i)},pushCloud:function(t,e){var i=this;l.pushCloud(this,t,e).then((function(t){if("200"==t.code){var e=t.data.playUrl;if(null!=e){var a=t.data.mediaType;i.videoType="m3u8"==a||"httpflv"==a?a:"rtmp",i.playUrl=e,i.isPlay=!0;var s=i.CustomBar+"px",n=wx.getStorageSync("screenHeight")+"px";i.style="height:calc(".concat(n," - 225px - ").concat(s,");margin-top:225px"),i.showVideo=!0}else i.$uniUtilsApi.showToast(i.i18n.camera.invalidAddress,"none",1e3,!1)}else if("201"==t.code)switch(t.msg){case"serverCompany":i.$uniUtilsApi.showToast(i.i18n.camera.equipmentNotSupported,"none",1e3,!1);break;case"OFFLINE":i.$uniUtilsApi.showToast(i.i18n.camera.equipmentOffline,"none",1e3,!1);break;default:i.$uniUtilsApi.showToast(i.i18n.camera.pushFailure,"none",1e3,!1);break}else i.$uniUtilsApi.showToast(i.i18n.camera.pushFailure,"none",1e3,!1)}))},closeVideo:function(){this.showVideo=!1,this.style=""},tapPlay:function(){var t=this.isPlay;t?this.playerContext.pause():this.playerContext.resume(),this.isPlay=!t},statechange:function(t){},error:function(t){}},components:{circleComponent:n.default}};e.default=x},"5b38":function(t,e,i){"use strict";i.r(e);var a=i("2a10"),s=i.n(a);for(var n in a)"default"!==n&&function(t){i.d(e,t,(function(){return a[t]}))}(n);e["default"]=s.a},"746fa":function(t,e,i){var a=i("24fb");e=a(!1),e.push([t.i,".ztnCustom-custominput[data-v-435f2920]{text-align:center;height:%?64?%;line-height:%?64?%}.custom-button[data-v-435f2920]{background-color:#fff}.custom-button[data-v-435f2920]::after{border:0}.selectButton[data-v-435f2920]{color:#fff;border:%?1?% solid var(--color);background-color:var(--color)}.noSelectButton[data-v-435f2920]{color:var(--color);border:%?1?% solid var(--color);background-color:#fff}",""]),t.exports=e},"7df6":function(t,e,i){"use strict";var a;i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return a}));var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"page",style:t.paddingBottomStyle},[t.isToHome?i("cu-custom",{attrs:{isHome:!0}},[i("template",{staticClass:"text-white",style:[{color:t.navigationBarTextColor}],attrs:{slot:"homeText"},slot:"homeText"},[t._v(t._s(t.deviceName))])],2):t.isLogin&&t.showVideo?i("cu-custom",{attrs:{isCustom:!0},on:{parentEvent:function(e){arguments[0]=e=t.$handleEvent(e),t.closeVideo.apply(void 0,arguments)}}},[i("template",{staticClass:"text-white",style:[{color:t.navigationBarTextColor}],attrs:{slot:"customText"},slot:"customText"},[t._v(t._s(t.i18n.close))])],2):i("cu-custom",{attrs:{isBack:!0}},[i("template",{staticClass:"text-white",style:[{color:t.navigationBarTextColor}],attrs:{slot:"backText"},slot:"backText"},[t._v(t._s(t.deviceName))])],2),t.showVideo?i("v-uni-view",{ref:"video",staticClass:"video-js",staticStyle:{position:"fixed",width:"100vw",height:"225px"}}):t._e(),i("v-uni-scroll-view",{style:t.style,attrs:{"scroll-y":"true"}},t._l(t.sensorWithSetting,(function(e,a){return i("v-uni-view",{key:a},[i("v-uni-view",{staticClass:"padding-lr margin-bottom"},[i("v-uni-view",{staticClass:"text-grey text-lg padding"},[t._v(t._s(e.sensorName)),i("v-uni-text",{staticClass:"margin-left-sm"},[t._v("["+t._s(e.type)+t._s(t.i18n.deviceController.port)+":"+t._s(e.port)+"]")])],1),t._l(e.settingList,(function(e,a){return i("v-uni-view",{key:a},[i("v-uni-view",{staticClass:"bg-white padding-sm margin-bottom",staticStyle:{"box-shadow":"0 5upx 15upx -5upx rgba(26, 26, 26, 0.2)","border-radius":"15upx"}},[i("v-uni-view",{staticClass:"flex align-center"},[i("v-uni-view",{staticClass:"cu-avatar margin-right-sm bg-white",staticStyle:{width:"55rpx",height:"55rpx"},style:[{backgroundImage:"url("+e.iconUrl+")"}]}),i("v-uni-view",[t._v(t._s(e.name)),""!=e.remark?i("v-uni-text",{staticClass:"margin-left-xs"},[t._v("[ "+t._s(e.remark)+" ]")]):t._e(),""!=e.childPort?i("v-uni-text",{staticClass:"margin-left-xs text-grey"},[t._v("["+t._s(t.i18n.deviceController.subport)+":"+t._s(e.childPort)+"]")]):t._e()],1)],1),i("v-uni-view",["custom"==e.type||"customProtocol"==e.type?i("v-uni-view",{staticClass:"margin-top-sm"},[i("v-uni-form",{attrs:{"data-setting":e.setting,"data-port":e.port,"data-childport":e.childPort,"data-change":"custom"},on:{submit:function(e){arguments[0]=e=t.$handleEvent(e),t.changeParam.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"flex align-center justify-end "},[i("v-uni-input",{staticClass:" margin-right-sm ztnCustom-custominput flex-sub ",staticStyle:{border:"1upx solid rgba(135, 153, 163, 0.5)","margin-left":"120upx"},attrs:{disabled:e.disabled,type:"text",name:"custom",value:e.value}}),i("v-uni-button",{staticClass:"cu-btn block",staticStyle:{"padding-left":"14px","padding-right":"14px",color:"#fff"},style:[{backgroundColor:t.emphasizeColor}],attrs:{disabled:e.disabled,"hover-class":"btn-hover-class",size:"mini","form-type":"submit"}},[t._v(t._s(t.i18n.confirm))])],1)],1)],1):"fixedParam"==e.type?i("v-uni-view",{staticClass:"margin-top-sm"},[i("v-uni-view",{staticClass:"flex align-center justify-end flex-wrap",attrs:{id:"fixedParam"}},t._l(e.paramList,(function(a,s){return i("v-uni-view",{key:s,staticStyle:{"margin-left":"20upx"}},[i("v-uni-button",{staticClass:"custom-button",class:[e.value==a.value?"selectButton":"noSelectButton"],style:{"--color":t.emphasizeColor},attrs:{disabled:e.disabled,size:"mini","data-setting":e.setting,"data-port":e.port,"data-childport":e.childPort,"data-value":a.value,"data-change":"fixed"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changeParam.apply(void 0,arguments)}}},[t._v(t._s(a.name))])],1)})),1)],1):"switch"==e.type?i("v-uni-view",[i("v-uni-view",{staticClass:"flex justify-end"},[i("v-uni-switch",{class:["default"==t.theme?"orange sm":"blue sm"],attrs:{disabled:e.disabled,checked:e.value,"data-setting":e.setting,"data-port":e.port,"data-childport":e.childPort,"data-change":"switch"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.changeParam.apply(void 0,arguments)}}})],1)],1):"time"==e.type?i("v-uni-view",{staticClass:"margin-top-sm"},[i("v-uni-view",{staticClass:"flex justify-end",staticStyle:{"margin-left":"120upx"}},[i("v-uni-picker",{staticClass:"flex-sub",attrs:{disabled:e.disabled,mode:"time",value:e.value,"data-setting":e.setting,"data-port":e.port,"data-childport":e.childPort,"data-change":"timeSet"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.changeParam.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"ztnCustom-custominput ",staticStyle:{border:"1upx solid rgba(135, 153, 163, 0.5)"}},[t._v(t._s(e.value))])],1)],1)],1):"timeSlot"==e.type?i("v-uni-view",{staticClass:"margin-top-sm"},[i("v-uni-view",{staticClass:"flex justify-end",staticStyle:{"margin-left":"120upx"}},[i("v-uni-picker",{staticClass:"flex-sub",attrs:{disabled:e.disabled,mode:"multiSelector","data-setting":e.setting,"data-port":e.port,"data-childport":e.childPort,"data-change":"periodTime",value:e.multiIndex,range:t.multiArray},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.changeParam.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"ztnCustom-custominput",staticStyle:{border:"1upx solid rgba(135, 153, 163, 0.5)"}},[t._v(t._s(e.value))])],1)],1)],1):"noParam"==e.type?i("v-uni-view",[i("v-uni-view",{staticClass:"flex  justify-end"},[i("v-uni-button",{staticClass:"cu-btn block",staticStyle:{"padding-left":"14px","padding-right":"14px",color:"#fff"},style:[{backgroundColor:t.emphasizeColor}],attrs:{disabled:e.disabled,"data-setting":e.setting,"data-port":e.port,"data-childport":e.childPort,"data-change":"nop"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changeParam.apply(void 0,arguments)}}},[t._v(t._s(t.i18n.confirm))])],1)],1):"slider"==e.type?i("v-uni-view",{staticClass:"margin-top-sm"},[i("v-uni-view",{staticClass:"flex justify-end",staticStyle:{"margin-left":"120upx"}},[i("v-uni-slider",{staticClass:"flex-sub",staticStyle:{"margin-right":"0upx","margin-left":"0upx"},attrs:{disabled:e.disabled,"show-value":!0,max:"100",min:"0",step:"5",value:e.value,activeColor:t.emphasizeColor,"block-size":"20","data-setting":e.setting,"data-port":e.port,"data-childport":e.childPort,"data-change":"slider"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.changeParam.apply(void 0,arguments)}}})],1)],1):"unKnow"==e.type?i("v-uni-view",[i("v-uni-form",{attrs:{"data-setting":e.setting,"data-port":e.port,"data-childport":e.childPort,"data-change":"custom"},on:{submit:function(e){arguments[0]=e=t.$handleEvent(e),t.changeParam.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"flex align-center justify-end "},[i("v-uni-input",{staticClass:"margin-right-sm ztnCustom-custominput flex-sub ",staticStyle:{border:"1upx solid rgba(135, 153, 163, 0.5)","margin-left":"120upx"},attrs:{disabled:e.disabled,type:"text",name:"custom",value:e.value}}),i("v-uni-button",{staticClass:"cu-btn block",staticStyle:{"padding-left":"14px","padding-right":"14px",color:"#fff"},style:[{backgroundColor:t.emphasizeColor}],attrs:{disabled:e.disabled,"hover-class":"btn-hover-class",size:"mini","form-type":"submit"}},[t._v(t._s(t.i18n.confirm))])],1)],1)],1):t._e()],1)],1)],1)}))],2)],1)})),1),!t.showVideo&&0!=t.cameraList.length&&t.isLogin?i("circleComponent",{staticStyle:{position:"fixed !important","z-index":"1024",right:"40upx"},style:[{bottom:"calc("+t.tabbarHeight+"px + 30rpx)"}],attrs:{circleWidth:85,circleHeight:85,circleBgColor:t.circleBgColor,circleBorder:""}},[i("v-uni-text",{staticClass:"cuIcon-camera",staticStyle:{"font-size":"0.7em"},style:[{color:t.emphasizeColor}],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openCameraListModal.apply(void 0,arguments)}}})],1):t._e(),i("v-uni-view",{staticClass:"cu-modal drawer-modal justify-start",class:[t.showCameraListModal?"show":""],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideCameraListModal.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"cu-dialog basis-lg",style:t.cameraListModalStyle},[i("v-uni-view",{staticClass:"cu-list menu text-left"},t._l(t.cameraList,(function(e,a){return i("v-uni-view",{key:a,staticClass:"cu-item arrow",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.tapCamera(e)}}},[i("v-uni-view",{staticClass:"content"},[i("v-uni-view",[i("v-uni-view",[t._v(t._s(e.name))]),t._v("#"+t._s(e.deviceId))],1)],1)],1)})),1)],1)],1),i("v-uni-view",{staticClass:"cu-modal bottom-modal",class:[t.showErrorModal?"show":""]},[i("v-uni-view",{staticClass:"cu-dialog"},[i("v-uni-view",{staticClass:"cu-bar bg-white"},[i("v-uni-view",{staticClass:"action text-red",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideErrorModal.apply(void 0,arguments)}}},[t._v(t._s(t.i18n.close))])],1),i("v-uni-view",{staticClass:"padding-xl"},[t._v(t._s(t.settingError))])],1)],1)],1)},n=[]},c5b2:function(t,e,i){"use strict";var a=i("2341"),s=i.n(a);s.a},f477:function(t,e,i){"use strict";function a(t,e){var i=t.$uniBaseRequest(t,"/device/sensor/list",{deviceCore:e,currentPage:1,pageSize:999});return i}function s(t,e,i,a){var s=t.$uniBaseRequest(t,"/device/sensor/data/listWithExplain",{enableEval:!0,sensorId:e,startTime:i,endTime:a});return s}function n(t,e,i,a){var s=t.$uniBaseRequest(t,"/history/device/sensor/data/listWithExplain",{enableEval:!0,sensorId:e,startTime:i,endTime:a});return s}function o(t,e,i,a,s){var n=t.$uniBaseRequest(t,"/device/sensor/listWith",{deviceCore:e,withExplain:i,withParam:a,withSetting:s});return n}Object.defineProperty(e,"__esModule",{value:!0}),e.getSensorList=a,e.getListWithExplain=s,e.getHistoryListWithExplain=n,e.getListWith=o},f83d:function(t,e,i){"use strict";i.r(e);var a=i("7df6"),s=i("5b38");for(var n in s)"default"!==n&&function(t){i.d(e,t,(function(){return s[t]}))}(n);i("c5b2");var o,r=i("f0c5"),l=Object(r["a"])(s["default"],a["b"],a["c"],!1,null,"435f2920",null,!1,a["a"],o);e["default"]=l.exports}}]);