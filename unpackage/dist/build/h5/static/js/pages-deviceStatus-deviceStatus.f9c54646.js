(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-deviceStatus-deviceStatus"],{"1c66":function(t,e,i){"use strict";function a(t,e,i,a,n,s){var o=t.$uniBaseRequest(t,"/device/status/pageGet",{deviceCore:e,startDate:i,endDate:a,currentPage:n,pageSize:s});return o}Object.defineProperty(e,"__esModule",{value:!0}),e.getDeviceStatus=a},"633b":function(t,e,i){var a=i("24fb");e=a(!1),e.push([t.i,"uni-page-body[data-v-7f8853c4]{background-color:#fff}body.?%PAGE?%[data-v-7f8853c4]{background-color:#fff}",""]),t.exports=e},"9a58":function(t,e,i){"use strict";var a=i("4ea4"),n=i("dbce");i("99af"),i("d3b7"),i("ac1f"),i("25f0"),i("5319"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n(i("ed3d")),o=n(i("1c66")),c=a(i("b060")),r={mixins:[c.default],data:function(){return{CustomBar:this.CustomBar,isToHome:!1,fromLoginBack:!1,isLoginOverdue:!1,navigationBarTextColor:"",downOption:{use:!0,auto:!1},upOption:{auto:!1,empty:{use:!0,fixed:!0,top:"20%"}},style:"",isShowList:!1,startDate:"",endDate:"",startTimestamp:"",endTimestamp:"",initEndTimestamp:"",initEndDate:"",deviceStatusList:[],deviceName:"",deviceCore:null,currentPage:1,pageSize:10}},computed:{i18n:function(){return this.$i18nMsg()},themei18n:function(){return this.$themei18nOption()}},onLoad:function(t){var e=uni.getStorageSync("isLogin")||!1;this.initOption=t,e?this.init(t):uni.navigateTo({url:"/pages/login/login"}),this.navigationBarTextColor=this.themei18n.navigationBarTextColor},onShow:function(){this.$uniUtilsApi.toHome(this);var t=this.initOption,e=this.fromLoginBack;e&&(this.init(t),this.fromLoginBack=!1,this.isLoginOverdue=!1)},methods:{downCallback:function(){this.currentPage=1,this.deviceStatusList=[],this.mescroll.resetUpScroll()},init:function(t){this.deviceName=t.deviceName||null,this.deviceCore=t.deviceCore||null,this.initDate()},initDate:function(){var t=new Date;this.startTimestamp=Math.round(t.getTime()/1e3-604800).toString(),this.endTimestamp=Math.round(t.getTime()/1e3+10).toString(),this.startDate=s.formatDate(this.startTimestamp),this.endDate=s.formatDate(this.endTimestamp),this.initEndTimestamp=this.endTimestamp,this.getDeviceStatus()},getDeviceStatus:function(t){var e=this,i=this.deviceCore,a=this.startTimestamp,n=this.endTimestamp,c=this.currentPage,r=this.pageSize;o.getDeviceStatus(this,i,a,n,c,r).then((function(t){if("200"==t.code){var i=t.data,a=i.currentPage,n=i.data,o=i.total,c=uni.getStorageSync("fixedHeight");c?(e.style="margin-top:".concat(c,"px"),e.isShowList=!0):e.$nextTick((function(){setTimeout((function(){uni.createSelectorQuery().select("#fixedBlock").boundingClientRect((function(t){var i=t.height;e.style="margin-top:".concat(i,"px"),e.isShowList=!0,uni.setStorageSync("fixedHeight",i)})).exec()}),0)}));for(var r=0;r<n.length;r++){var l=e.$uniUtilsApi.handleDeviceStatus(e.i18n.status,n[r].status),u=l.deviceStatu;n[r].deviceStatu=u,n[r].timestamp=s.formatDateTime(n[r].timestamp,e.i18n.unknown)}e.mescroll.endByPage(n.length,o);var v=a-1;e.$set(e.deviceStatusList,v,n),e.currentPage=a+1}}))},startDateChange:function(t){var e=t.detail.value.replace(/-/g,"/"),i=(new Date(e).getTime()/1e3).toString(),a=this.endTimestamp;a<i||a==i?this.$uniUtilsApi.showToast(this.i18n.lessEndDate,"none",1e3,!1):(this.startTimestamp=i,this.startDate=t.detail.value,this.currentPage=1,this.deviceStatusList=[],this.mescroll.scrollTo(0,300),this.mescroll.resetUpScroll())},endDateChange:function(t){var e=t.detail.value.replace(/-/g,"/"),i=(new Date(e).getTime()/1e3+86400).toString(),a=this.startTimestamp;a>i||a==i?this.$uniUtilsApi.showToast(this.i18n.greaterStartDate,"none",1e3,!1):(this.endTimestamp=i,this.endDate=t.detail.value,this.currentPage=1,this.deviceStatusList=[],this.mescroll.scrollTo(0,300),this.mescroll.resetUpScroll())},deviceNavigation:function(t,e,i){uni.navigateTo({url:"/pages/deviceNavigation/deviceNavigation?deviceName=".concat(t,"&deviceCore=").concat(e,"&pageCur=").concat(i)})}},onShareAppMessage:function(t){var e=this.deviceName,i=this.deviceCore,a=uni.getStorageSync("nickName"),n=uni.getStorageSync("shortCompanyName");return{title:null==e?"".concat(a).concat(this.i18n.moreOperate.share).concat(n):"".concat(a).concat(this.i18n.moreOperate.share).concat(e),path:null==i?"/pages/deviceStatus/deviceStatus":"/pages/deviceStatus/deviceStatus?deviceName=".concat(e,"&&deviceCore=").concat(i),success:function(t){}}}};e.default=r},b060:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={data:function(){return{mescroll:null}},onPullDownRefresh:function(){this.mescroll&&this.mescroll.onPullDownRefresh()},onPageScroll:function(t){this.mescroll&&this.mescroll.onPageScroll(t)},onReachBottom:function(){this.mescroll&&this.mescroll.onReachBottom()},methods:{mescrollInit:function(t){this.mescroll=t,this.mescrollInitByRef()},mescrollInitByRef:function(){if(!this.mescroll||!this.mescroll.resetUpScroll){var t=this.$refs.mescrollRef;t&&(this.mescroll=t.mescroll)}},downCallback:function(){var t=this;this.mescroll.optUp.use?this.mescroll.resetUpScroll():setTimeout((function(){t.mescroll.endSuccess()}),500)},upCallback:function(){var t=this;setTimeout((function(){t.mescroll.endErr()}),500)}},mounted:function(){this.mescrollInitByRef()}},n=a;e.default=n},c50a:function(t,e,i){"use strict";i.r(e);var a=i("f955"),n=i("d7848");for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);i("d191");var o,c=i("f0c5"),r=Object(c["a"])(n["default"],a["b"],a["c"],!1,null,"7f8853c4",null,!1,a["a"],o);e["default"]=r.exports},ca2e:function(t,e,i){var a=i("633b");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("112aa6ef",a,!0,{sourceMap:!1,shadowMode:!1})},d191:function(t,e,i){"use strict";var a=i("ca2e"),n=i.n(a);n.a},d7848:function(t,e,i){"use strict";i.r(e);var a=i("9a58"),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,(function(){return a[t]}))}(s);e["default"]=n.a},f955:function(t,e,i){"use strict";var a;i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return a}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[t.isToHome?i("cu-custom",{attrs:{isHome:!0}},[i("template",{staticClass:"text-white",style:[{color:t.navigationBarTextColor}],attrs:{slot:"homeText"},slot:"homeText"},[t._v(t._s(null!=t.deviceName?t.deviceName:""))])],2):i("cu-custom",{attrs:{isBack:!0}},[i("template",{staticClass:"text-white",style:[{color:t.navigationBarTextColor}],attrs:{slot:"backText"},slot:"backText"},[t._v(t._s(null!=t.deviceName?t.deviceName:""))])],2),i("v-uni-view",{staticClass:"padding bg-white ",staticStyle:{position:"fixed",left:"0",width:"100%","z-index":"1024","box-shadow":"0 1rpx 6rpx rgba(0, 0, 0, 0.1)",display:"block"},attrs:{id:"fixedBlock"}},[i("v-uni-view",{staticClass:"flex justify-around align-center"},[i("v-uni-picker",{attrs:{mode:"date",value:t.startDate,end:t._f("formatDate")(t.initEndTimestamp)},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.startDateChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"text-grey"},[t._v(t._s(t.startDate))])],1),i("v-uni-view",[t._v(t._s(t.i18n.to))]),i("v-uni-picker",{attrs:{mode:"date",end:t._f("formatDate")(t.initEndTimestamp)},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.endDateChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"text-grey"},[t._v(t._s(t.endDate))])],1)],1)],1),i("mescroll-body",{ref:"mescrollRef",attrs:{down:t.downOption,up:t.upOption},on:{init:function(e){arguments[0]=e=t.$handleEvent(e),t.mescrollInit.apply(void 0,arguments)},down:function(e){arguments[0]=e=t.$handleEvent(e),t.downCallback.apply(void 0,arguments)},up:function(e){arguments[0]=e=t.$handleEvent(e),t.getDeviceStatus.apply(void 0,arguments)}}},t._l(t.deviceStatusList,(function(e,a){return t.isShowList?i("v-uni-view",{key:a,style:0==a?t.style:""},t._l(e,(function(e,a){return i("v-uni-view",{key:a,staticClass:"cu-timeline"},["ONLINE"==e.status?i("v-uni-view",{staticClass:"cu-item cur cuIcon-noticefill",staticStyle:{color:"#8dc63f"}},[null==t.deviceCore?i("v-uni-view",{staticClass:"content bg-olive light",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.deviceNavigation(e.deviceName,e.deviceCore,"deviceInfo")}}},[i("v-uni-view",{staticStyle:{color:"#666666"}},[t._v(t._s(e.deviceName))]),i("v-uni-view",[t._v(t._s(e.deviceCore))]),i("v-uni-text",{staticClass:"text-gray margin-right-sm"},[t._v(t._s(e.timestamp))])],1):i("v-uni-view",{staticClass:"content bg-olive light"},[i("v-uni-text",{staticClass:"margin-right-sm",staticStyle:{color:"#666666"}},[t._v(t._s(e.timestamp))]),t._v(t._s(e.deviceStatu))],1)],1):t._e(),"OFFLINE"==e.status?i("v-uni-view",{staticClass:"cu-time text-grey"},[t._v(t._s(t.i18n.status[1]))]):t._e(),"OFFLINE"==e.status?i("v-uni-view",{staticClass:"cu-item cuIcon-attentionforbidfill"},[null==t.deviceCore?i("v-uni-view",{staticClass:"content bg-grey light",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.deviceNavigation(e.deviceName,e.deviceCore,"deviceInfo")}}},[i("v-uni-view",{staticStyle:{color:"#666666"}},[t._v(t._s(e.deviceName))]),i("v-uni-view",[t._v(t._s(e.deviceCore))]),i("v-uni-text",{staticClass:"text-gray margin-right-sm"},[t._v(t._s(e.timestamp))]),i("v-uni-text",{staticClass:"text-grey"},[t._v(t._s(e.deviceStatu))])],1):i("v-uni-view",{staticClass:"content bg-grey light"},[i("v-uni-text",{staticClass:"margin-right-sm",staticStyle:{color:"#666666"}},[t._v(t._s(e.timestamp))]),i("v-uni-text",{staticClass:"text-gray"},[t._v(t._s(e.deviceStatu))])],1)],1):t._e()],1)})),1):t._e()})),1)],1)},s=[]}}]);