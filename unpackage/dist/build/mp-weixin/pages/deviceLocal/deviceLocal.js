(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/deviceLocal/deviceLocal"],{1893:function(t,e,i){"use strict";i.r(e);var n=i("2ea7"),a=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a},"2ea7":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(i("5c69"));function a(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function o(t){if(t&&t.__esModule)return t;if(null===t||"object"!==typeof t&&"function"!==typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var r=n?Object.getOwnPropertyDescriptor(t,o):null;r&&(r.get||r.set)?Object.defineProperty(i,o,r):i[o]=t[o]}return i.default=t,e&&e.set(t,i),i}var r={data:function(){return{CustomBar:this.CustomBar,isToHome:!1,fromLoginBack:!1,isLoginOverdue:!1,navigationBarTextColor:"",emphasizeColor:"",lightColor:"",scrollStyle:"",isShowMap:!1,scale:8,longitude:"",latitude:"",markers:[],deviceLocalList:[],deviceName:"",deviceCore:"",currentPage:1,pageSize:50,isShowAuthorizeModal:!1,navigationItem:null}},computed:{i18n:function(){return this.$i18nMsg()},themei18n:function(){return this.$themei18nOption()}},onReady:function(){this.navigationBarTextColor=this.themei18n.navigationBarTextColor;var t,e=this.themei18n.theme;switch(e){case"default":t="orangeLight";break;case"darkColor":t="blueLight";break;case"lightColor":t="blueLight";break;default:break}this.lightColor=this.themei18n.lightColor[t],this.emphasizeColor=this.themei18n.emphasizeColor},onLoad:function(e){var i=t.getStorageSync("isLogin")||!1;this.initOption=e,i?this.init(e):t.navigateTo({url:"/pages/login/login"})},onShow:function(){this.$uniUtilsApi.toHome(this);var t=this.initOption,e=this.fromLoginBack;e&&(this.init(t),this.fromLoginBack=!1,this.isLoginOverdue=!1)},methods:{init:function(t){this.deviceName=t.deviceName,this.deviceCore=t.deviceCore,this.getDeviceLocal()},getDeviceLocal:function(){var e=this,i=this.deviceCore,a=this.currentPage,o=this.pageSize;n.getDeviceLocal(this,i,a,o).then((function(i){if("200"==i.code){var n=i.data.data;if(n.length<1){var a=e.i18n.noData;return e.$uniUtilsApi.showToast(a,"none",1e3,!1),void setTimeout((function(){t.navigateBack({delta:1})}),1e3)}for(var o=0;o<n.length;o++){var r={},c={},s=Number(n[o].lat),u=Number(n[o].lng);r.width=25,r.height=25,r.latitude=s,r.longitude=u,r.iconPath="../../static/numsImage/local_".concat(o+1,".png"),e.$set(e.markers,o,r),c.timestamp=n[o].timestamp,c.radius=n[o].radius+"ç±³",c.address=n[o].address,c.lat=n[o].lat,c.lng=n[o].lng,e.$set(e.deviceLocalList,o,c)}e.latitude=s,e.longitude=u,e.isShowMap=!0;var l=e.CustomBar,h=t.getStorageSync("screenHeight"),d=t.getStorageSync("mapHeight");d?e.scrollStyle="height:".concat(h-d-l,"px"):e.$nextTick((function(){setTimeout((function(){t.createSelectorQuery().select("#myMap").boundingClientRect((function(i){var n=i.height;e.scrollStyle="height:".concat(h-n-l,"px"),t.setStorageSync("mapHeight",n)})).exec()}),200)}))}}))},tapMarker:function(t){var e=t.lat,i=t.lng;this.latitude=e,this.longitude=i},navigation:function(e){var i=this;this.$uniUtilsApi.showLoading(this.i18n.loading,!0);var n=this.deviceName,a=e.lat,o=e.lng,r=e.address;t.getLocation({type:"wgs84",success:function(e){i.$uniUtilsApi.hideLoading(),t.openLocation({latitude:a,longitude:o,name:n,address:r})},fail:function(t){i.$uniUtilsApi.hideLoading(),i.navigationItem=e,i.showAuthorizeModal()}})},showAuthorizeModal:function(){this.isShowAuthorizeModal=!0},hideAuthorizeModal:function(){this.isShowAuthorizeModal=!1},authorizeManage:function(t){var e=t.detail.authSetting;if(e["scope.userLocation"]){var i=this.navigationItem;this.hideAuthorizeModal(),this.navigation(i)}}},onShareAppMessage:function(e){var i=this.deviceName,n=this.deviceCore,a=t.getStorageSync("nickName");return{title:"".concat(a).concat(this.i18n.moreOperate.share).concat(i),path:"/pages/deviceLocal/deviceLocal?deviceName=".concat(i,"&&deviceCore=").concat(n),success:function(t){}}}};e.default=r}).call(this,i("543d")["default"])},"57c0":function(t,e,i){"use strict";i.r(e);var n=i("d5ba"),a=i("1893");for(var o in a)"default"!==o&&function(t){i.d(e,t,(function(){return a[t]}))}(o);var r,c=i("f0c5"),s=Object(c["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);e["default"]=s.exports},af68:function(t,e,i){"use strict";(function(t){i("91b7"),i("921b");n(i("66fd"));var e=n(i("57c0"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},d5ba:function(t,e,i){"use strict";var n;i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}));var a=function(){var t=this,e=t.$createElement,i=(t._self._c,t.__map(t.deviceLocalList,(function(e,i){var n=t.__get_orig(e),a=t._f("formatDateTime")(e.timestamp,t.i18n.unknown);return{$orig:n,f0:a}})));t.$mp.data=Object.assign({},{$root:{l0:i}})},o=[]}},[["af68","common/runtime","common/vendor"]]]);