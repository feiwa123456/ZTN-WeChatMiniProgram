(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/deviceController/deviceController"],{"5b38":function(t,e,i){"use strict";i.r(e);var a=i("6071"),n=i.n(a);for(var r in a)"default"!==r&&function(t){i.d(e,t,(function(){return a[t]}))}(r);e["default"]=n.a},6071:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=s(i("a549")),n=s(i("f477")),r=s(i("0b74"));function o(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}function s(t){if(t&&t.__esModule)return t;if(null===t||"object"!==typeof t&&"function"!==typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=a?Object.getOwnPropertyDescriptor(t,n):null;r&&(r.get||r.set)?Object.defineProperty(i,n,r):i[n]=t[n]}return i.default=t,e&&e.set(t,i),i}for(var c=function(){i.e("components/ztn-custom/circleComponent/circleComponent").then(function(){return resolve(i("165c"))}.bind(null,i)).catch(i.oe)},u=[],l=[],h=[],d=[],f=0;f<24;f++){var p=f+"";u[f]=p[1]?p:"0"+p}for(var m=0;m<60;m++){var v=m+"";l[m]=v[1]?v:"0"+v}for(var g=0;g<24;g++){var y=g+"";h[g]=y[1]?y:"0"+y}for(var b=0;b<60;b++){var C=b+"";d[b]=C[1]?C:"0"+C}var S={data:function(){return{CustomBar:this.CustomBar,isLogin:!1,isLoginOverdue:!1,navigationBarTextColor:"",showVideo:!1,cameraList:[],cameraListModalStyle:"",showCameraListModal:!1,videoType:"",playUrl:"",playerContext:null,direction:"vertical",isPlay:!1,pushTime:60,playIcon:"../../static/images/cam/play.png",pauseIcon:"../../static/images/cam/pause.png",circleBgColor:"#f8f8f8",style:"",sensorWithSetting:[],multiArray:[u,l,h,d],multiIndex:[0,0,0,0],settingError:"",showErrorModal:!1,emphasizeColor:"",selectButton:"",paddingBottomStyle:"",theme:""}},props:{deviceName:{type:String,default:""},deviceCore:{type:String,default:""},tabbarHeight:{type:[Number,String],default:0},isToHome:{type:Boolean,default:!1}},computed:{i18n:function(){return this.$i18nMsg()},themei18n:function(){return this.$themei18nOption()}},beforeMount:function(){var t,e=this.themei18n.emphasizeColor,i=this.themei18n.theme;switch(this.theme=i,i){case"default":t="orangeLight";break;case"darkColor":t="blueLight";break;case"lightColor":t="blueLight";break;default:break}var a=this.themei18n.lightColor;this.circleBgColor=a[t],this.emphasizeColor=e,this.selectButton="background:${emphasizeColor};color:#fff; border: 1upx solid ${emphasizeColor}"},mounted:function(){var e=t.getStorageSync("isLogin")||!1;this.isLogin=e,e&&this.init()},methods:{init:function(){this.sensorWithSetting=[],this.cameraList=[],this.getListWith(),this.getCameraList(),this.navigationBarTextColor=this.themei18n.navigationBarTextColor},getListWith:function(){var t=this,e=this.deviceCore,i=!1,a=!1,r=!0;n.getListWith(this,e,i,a,r).then((function(e){if("200"==e.code){var i=e.data.filter((function(t,e){return 0==t.hidden}));if(i.length>0){for(var a=i.filter((function(t,e){return 0!=t.settingList.length})),n=0;n<a.length;n++){var r=a[n].type;a[n].type=t.i18n.deviceSensor.sensorType[r],a[n].settingList=t.getSettingList(a[n].settingList)}t.sensorWithSetting=a}}}))},getSettingList:function(t){for(var e=t.filter((function(t,e,i){return 0==t.hidden})),i=0;i<e.length;i++)if("switch"==e[i].type)e[i].value=1==e[i].value;else if("timeSlot"==e[i].type)if(-1!=e[i].value.indexOf("/")){var a=e[i].value.split(" / "),n=a[0].split(":"),r=a[1].split(":");e[i].multiIndex=n.concat(r),e[i].value=n.map(this.formatNumber).join(":")+" / "+r.map(this.formatNumber).join(":")}else e[i].multiIndex=[0,0,0,0];return e},formatNumber:function(t){return t=t.toString(),t[1]?t:"0"+t},changeParam:function(t){var e=t.currentTarget.dataset,i=e.change,a=e.keyname||"",n=e.port||"",r=e.childport||"";switch(i){case"custom":var o=t.detail.value.custom;this.saveSetting(o,a,n,r);break;case"fixed":var s=e.value;this.saveSetting(s,a,n,r);break;case"switch":var c=t.detail.value?"1":"0";this.saveSetting(c,a,n,r);break;case"timeSet":var u=t.detail.value;this.saveSetting(u,a,n,r);break;case"periodTime":var l=t.detail.value,h=this.multiArray[0][l[0]],d=this.multiArray[1][l[1]],f=this.multiArray[2][l[2]],p=this.multiArray[3][l[3]],m=h+":"+d+" / "+f+":"+p;this.saveSetting(m,a,n,r);break;case"nop":this.saveSetting(null,a,n,r);break;case"slider":var v=t.detail.value;this.saveSetting(v,a,n,r);break;default:}},saveSetting:function(t,e,i,n){var r=this;this.$uniUtilsApi.showLoading(this.i18n.loading,!0);var o=this.deviceCore;a.saveSetting(this,o,t,e,i,n).then((function(t){"200"==t.code&&(r.$uniUtilsApi.hideLoading(),r.$uniUtilsApi.showToast(r.i18n.setSuccess,"none",1e3,!0),r.getListWith())}))},hideErrorModal:function(){this.showErrorModal=!1},getCameraList:function(){var e=this,i=this.deviceCore,a=t.getStorageSync("userId");r.getCameraList(this,a,i).then((function(t){var i=e.tabbarHeight;"200"==t.code?(e.cameraList=t.data,e.paddingBottomStyle="padding-bottom:calc(".concat(i,"px + 110rpx)")):e.paddingBottomStyle="padding-bottom:".concat(i,"px")}))},openCameraListModal:function(){var t=this.CustomBar;this.cameraListModalStyle="top:".concat(t,"px;height:calc(100vh - {{CustomBar}}px)"),this.showCameraListModal=!0},hideCameraListModal:function(){this.showCameraListModal=!1},tapCamera:function(t){var e=t.deviceId,i=this.pushTime;this.pushCloud(e,i)},pushCloud:function(t,e){var i=this;r.pushCloud(this,t,e).then((function(t){if("200"==t.code){var e=t.data.playUrl;if(null!=e){var a=t.data.mediaType;i.videoType="m3u8"==a||"httpflv"==a?a:"rtmp",i.playUrl=e,i.isPlay=!0;var n=i.CustomBar+"px",r=wx.getStorageSync("screenHeight")+"px";i.style="height:calc(".concat(r," - 225px - ").concat(n,");margin-top:225px"),i.showVideo=!0}else i.$uniUtilsApi.showToast(i.i18n.camera.invalidAddress,"none",1e3,!1)}else if("201"==t.code)switch(t.msg){case"serverCompany":i.$uniUtilsApi.showToast(i.i18n.camera.equipmentNotSupported,"none",1e3,!1);break;case"OFFLINE":i.$uniUtilsApi.showToast(i.i18n.camera.equipmentOffline,"none",1e3,!1);break;default:i.$uniUtilsApi.showToast(i.i18n.camera.pushFailure,"none",1e3,!1);break}else i.$uniUtilsApi.showToast(i.i18n.camera.pushFailure,"none",1e3,!1)}))},closeVideo:function(){this.showVideo=!1,this.style=""},tapPlay:function(){var t=this.isPlay;t?this.playerContext.pause():this.playerContext.resume(),this.isPlay=!t},statechange:function(t){},error:function(t){}},components:{circleComponent:c}};e.default=S}).call(this,i("543d")["default"])},8619:function(t,e,i){},c6af:function(t,e,i){"use strict";(function(t){i("91b7"),i("921b");a(i("66fd"));var e=a(i("f83d"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},ce27:function(t,e,i){"use strict";var a;i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return a}));var n=function(){var t=this,e=t.$createElement;t._self._c},r=[]},f17b:function(t,e,i){"use strict";var a=i("8619"),n=i.n(a);n.a},f83d:function(t,e,i){"use strict";i.r(e);var a=i("ce27"),n=i("5b38");for(var r in n)"default"!==r&&function(t){i.d(e,t,(function(){return n[t]}))}(r);i("f17b");var o,s=i("f0c5"),c=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"d5d10e64",null,!1,a["a"],o);e["default"]=c.exports}},[["c6af","common/runtime","common/vendor"]]]);