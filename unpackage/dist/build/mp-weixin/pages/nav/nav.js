(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/nav/nav"],{"0e7b":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=h(n("5684")),r=h(n("4724")),o=h(n("44f2")),a=h(n("1c5d")),s=d(n("0db3")),c=d(n("870a")),u=(d(n("5891")),h(n("a202")));function l(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return l=function(){return t},t}function d(t){if(t&&t.__esModule)return t;if(null===t||"object"!==typeof t&&"function"!==typeof t)return{default:t};var e=l();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=i?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=t[r]}return n.default=t,e&&e.set(t,n),n}function h(t){return t&&t.__esModule?t:{default:t}}var f=function(){n.e("components/ztn-custom/tabbar/tabbar").then(function(){return resolve(n("6cbf"))}.bind(null,n)).catch(n.oe)},p={mixins:[u.default],data:function(){return{CustomBar:this.CustomBar,fromLoginBack:!1,refresh:!1,isLogin:!1,pageCur:"",tabbarList:[],tabbarHeight:"",isShow:!0,themeColor:"#70c8e2",currentProductId:null}},computed:{i18n:function(){return this.$i18nMsg()}},onReady:function(){},onLoad:function(){this.getCompanyInfo(),this.initTabbar()},onShow:function(){var e=this,n=this.fromLoginBack,i=this.refresh;if(n||i){var r=t.getStorageSync("language");n&&this.lang(r);var o=this.pageCur;this.pageCur="",this.$nextTick((function(){e.pageCur=o,e.fromLoginBack=!1,e.refresh=!1,e.isLogin=!0}))}},methods:{getCompanyInfo:function(){var t=this,e=this.$uniUtilsApi.getCompanyInfo(this);e.then((function(){t.pageCur="home",t.init()}))},initTabbar:function(){this.tabbarList=[{tabbar:"home",tabbarName:this.i18n.nav.home,tabbarCuIcon:"cuIcon-homefill"},{tabbar:"map",tabbarName:this.i18n.nav.map,tabbarCuIcon:"cuIcon-locationfill"},{tabbar:"list",tabbarName:this.i18n.nav.list,tabbarCuIcon:"cuIcon-circlefill"},{tabbar:"center",tabbarName:this.i18n.nav.center,tabbarCuIcon:"cuIcon-peoplefill"}]},init:function(){var e=this.i18n.openMessage,n=this.i18n.closeMessage;this.$uniUtilsApi.connectSocket(),this.$uniUtilsApi.openSocket(e,n);var i=t.getStorageSync("openid");i?(this.openid=i,this.useOpenidLogin()):this.WEIXINGetOpenid()},getTabbarHeight:function(t){this.tabbarHeight=t},navChange:function(e){var n=t.getStorageSync("isLogin"),i=this.pageCur;i!==e?(this.pageCur=e,"list"===i&&(this.currentProductId=null)):n&&("home"===e&&this.$refs["".concat(e)].initResource(),"list"===e?this.$refs.mescrollItem.refresh():this.$refs["".concat(e)].init(),this.$uniUtilsApi.showToast(this.i18n.refreshSuccess,"none",1e3,!1))},isShowNav:function(t){this.isShow=t},showMapFav:function(e){t.$emit("MapFavValue",e)},list:function(t){this.currentProductId=t.productId,this.pageCur=t.pageCur},themeChange:function(){this.$refs.tabbar.themeChange()},languageChange:function(){this.initTabbar()},unLogin:function(){this.isLogin=!1},WEIXINGetOpenid:function(){var e=this,n=t.getStorageSync("companyId");t.login({success:function(i){c.WEIXINGetOpenid(e,i.code,n).then((function(n){e.openid=n.data.openid,t.setStorageSync("openid",e.openid),e.useOpenidLogin()}))},fail:function(t){e.$uniUtilsApi.showToast(e.i18n.login.userInfoFail,"none",1e3,!1)}})},H5GetOpenid:function(){var e=window.location.href,n=e.split("?")[1];if(n){var i=new URLSearchParams(n);i&&"singlemessage"==i.get("from")&&(this.openid=i.get("openid"),t.setStorageSync("openid",this.openid),this.useOpenidLogin())}},useOpenidLogin:function(e){var n=this,i=this.openid,r=t.getStorageSync("companyId");e=s.userLogin(this,{companyId:r,openid:i,getType:"wxApp"});e.then((function(e){if(e.status)switch(e.code){case"200":var i=e.data,r=i.userId,o=i.userName,a=i.devKey,s=i.accessToken,c=i.singleLogin,u=i.language,l="zh"==u?0:1;t.setStorageSync("userId",r),t.setStorageSync("userName",o),t.setStorageSync("devKey",a),t.setStorageSync("accessToken",s),t.setStorageSync("singleLogin",c),t.setStorageSync("language",u),t.setStorageSync("languageIndex",l),t.setStorageSync("isLogin",!0),n.isLogin=!0,n.lang(u);break;case"201":t.setStorageSync("isLogin",!1),n.isLogin=!1,n.$uniUtilsApi.showToast(n.i18n.login.bindUser,"none",1e3,!1),n.lang(t.getStorageSync("language"));break;default:n.$uniUtilsApi.showToast(n.i18n.login.unknownError,"none",1e3,!1);break}}))},lang:function(t){this.$i18n.locale=t,this.languageChange()}},components:{homeComponent:i.default,mapComponent:r.default,listComponent:o.default,centerComponent:a.default,tabbar:f},onShareAppMessage:function(e){var n=this.pageCur,i=t.getStorageSync("nickName"),r=t.getStorageSync("shortCompanyName");return{title:"".concat(i).concat(this.i18n.moreOperate.share).concat(r),path:"/pages/nav/nav?pageCur=".concat(n),success:function(t){}}}};e.default=p}).call(this,n("543d")["default"])},"19d9":function(t,e,n){"use strict";n.r(e);var i=n("e289"),r=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=r.a},"1c5d":function(t,e,n){"use strict";n.r(e);var i=n("4a18"),r=n("c57a");for(var o in r)"default"!==o&&function(t){n.d(e,t,(function(){return r[t]}))}(o);var a,s=n("f0c5"),c=Object(s["a"])(r["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],a);e["default"]=c.exports},"273d":function(t,e,n){"use strict";var i=n("9f41"),r=n.n(i);r.a},3364:function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}));var r=function(){var t=this,e=t.$createElement;t._self._c},o=[]},"44f2":function(t,e,n){"use strict";n.r(e);var i=n("9d0b"),r=n("c75a");for(var o in r)"default"!==o&&function(t){n.d(e,t,(function(){return r[t]}))}(o);var a,s=n("f0c5"),c=Object(s["a"])(r["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],a);e["default"]=c.exports},4724:function(t,e,n){"use strict";n.r(e);var i=n("f715"),r=n("90fe");for(var o in r)"default"!==o&&function(t){n.d(e,t,(function(){return r[t]}))}(o);n("273d");var a,s=n("f0c5"),c=Object(s["a"])(r["default"],i["b"],i["c"],!1,null,"34c5fe3c",null,!1,i["a"],a);e["default"]=c.exports},"4a18":function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}));var r=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.isLogin?t.tapCurrentVersion():t.unLogin()},t.e1=function(e){t.isLogin?t.moreOperate():t.unLogin()},t.e2=function(e){t.isLogin?t.deviceNotice():t.unLogin()},t.e3=function(e){t.isLogin?t.tapScan():t.unLogin()},t.e4=function(e){t.isLogin?t.deviceError():t.unLogin()},t.e5=function(e){t.isLogin?t.deviceStatus():t.unLogin()},t.e6=function(e){t.isLogin?t.more():t.unLogin()},t.e7=function(e){t.isLogin?t.pushMessage():t.unLogin()})},o=[]},"4d26":function(t,e,n){},5225:function(t,e,n){"use strict";var i=n("6bd7"),r=n.n(i);r.a},"52c0":function(t,e,n){"use strict";n.r(e);var i=n("3364"),r=n("7102");for(var o in r)"default"!==o&&function(t){n.d(e,t,(function(){return r[t]}))}(o);n("9aa3");var a,s=n("f0c5"),c=Object(s["a"])(r["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],a);e["default"]=c.exports},5684:function(t,e,n){"use strict";n.r(e);var i=n("7829"),r=n("19d9");for(var o in r)"default"!==o&&function(t){n.d(e,t,(function(){return r[t]}))}(o);n("5225");var a,s=n("f0c5"),c=Object(s["a"])(r["default"],i["b"],i["c"],!1,null,"a7952658",null,!1,i["a"],a);e["default"]=c.exports},"6bd7":function(t,e,n){},"6cc7":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=u(n("a34a")),r=c(n("9bc8")),o=c(n("9a3a")),a=u(n("b060"));function s(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function c(t){if(t&&t.__esModule)return t;if(null===t||"object"!==typeof t&&"function"!==typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=i?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=t[r]}return n.default=t,e&&e.set(t,n),n}function u(t){return t&&t.__esModule?t:{default:t}}function l(t){return p(t)||f(t)||h(t)||d()}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(t,e){if(t){if("string"===typeof t)return g(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(t,e):void 0}}function f(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function p(t){if(Array.isArray(t))return g(t)}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function v(t,e,n,i,r,o,a){try{var s=t[o](a),c=s.value}catch(u){return void n(u)}s.done?e(c):Promise.resolve(c).then(i,r)}function m(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function a(t){v(o,i,r,a,s,"next",t)}function s(t){v(o,i,r,a,s,"throw",t)}a(void 0)}))}}var S=function(){n.e("components/ztn-custom/surplus/surplus").then(function(){return resolve(n("617a"))}.bind(null,n)).catch(n.oe)},y=function(){n.e("components/ztn-custom/listFav/listFav").then(function(){return resolve(n("ca37"))}.bind(null,n)).catch(n.oe)},L={mixins:[a.default],data:function(){return{CustomBar:this.CustomBar,isLogin:!0,isLoginOverdue:!1,customIcon:"cuIcon-sort",downOption:{use:!0,auto:!1},upOption:{use:!0,auto:!1,empty:{use:!0,fixed:!0,top:"25%"}},imageSrc:"/static/images/noContent.png",navScrollHeight:0,isShowNavScroll:!1,isShowList:!1,searchNameInput:"",isShowSearchButton:!1,productTypeList:[],productTypeData:[],productSeriesList:[],productSeriesData:[],productTypeSeriesList:[],productTypeSeriesListCopy:[],productGroupList:[],productGroupData:[],productPageList:[],currentStatusIndex:0,currentTypeSeriesIndex:[0,0],currentTypeSeriesIndexCopy:[0,0],currentAlarmIndex:0,currentGroupIndex:0,currentPageIndex:0,deviceList:[],searchStatus:null,productId:null,seriesId:null,groupId:null,searchName:null,todayOnline:!1,warnDesc:!1,currentPage:1,pageSize:10}},name:"listComponent",computed:{i18n:function(){return this.$i18nMsg()}},props:{currentProductId:{type:[Number,String],default:null},tabbarHeight:{type:[Number,String],default:""}},mounted:function(){var e=t.getStorageSync("isLogin")||!1;this.isLogin=e,e&&this.init()},methods:{refresh:function(){var t=this;this.mescroll.scrollTo(0,300),setTimeout((function(){t.mescroll.triggerDownScroll()}),500)},init:function(){var t=this,e=this.currentProductId;this.productId=e,this.getDeviceList(),this.getProductGroupList(),this.getTypeSeries().then((function(n){var i=t.productTypeList,r=t.productTypeData,o=t.productSeriesList;t.productTypeSeriesList=[i,o],t.productTypeSeriesListCopy=[i,o];var a=r.findIndex((function(t){return t.productId===e}));t.currentTypeSeriesIndex=[a,0],t.currentTypeSeriesIndexCopy=[a,0]}))},downCallback:function(){this.currentPage=1,this.deviceList=[],this.mescroll.resetUpScroll()},getTypeSeries:function(){var t=m(i.default.mark((function t(){var e;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.productId,t.next=3,this.getProductTypeList();case 3:if(!e){t.next=8;break}return t.next=6,this.getProductSeriesList();case 6:t.next=9;break;case 8:this.handleProductSeriesList([]);case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getProductTypeList:function(){var e=this,n=t.getStorageSync("userId");return new Promise((function(t,i){r.getProductTypeList(e,n).then((function(n){if("200"==n.code){var i=n.data,r=e.$uniUtilsApi.handleProductType(e,i),o=r.productTypeList,a=r.productTypeData;e.productTypeList=o,e.productTypeData=a,t()}}))}))},getProductSeriesList:function(){var e=this,n=t.getStorageSync("userId"),i=this.productId;return new Promise((function(t,o){r.getProductSeries(e,n,i).then((function(n){if("200"==n.code){var i=n.data;e.handleProductSeriesList(i),t()}}))}))},handleProductSeriesList:function(t){var e=this.$uniUtilsApi.handleProductSeries(this,t),n=e.productSeriesList,i=e.productSeriesData;this.productSeriesList=n,this.productSeriesData=i},getProductGroupList:function(){var e=this,n=t.getStorageSync("userId");o.getProductGroupList(this,n).then((function(t){if("200"==t.code){var n=t.data,i=e.$uniUtilsApi.handleProductGroup(e,n),r=i.productGroupList,o=i.productGroupData;e.productGroupList=r,e.productGroupData=o}}))},getDeviceList:function(){var e=this,n=t.getStorageSync("userId"),i=this.searchStatus,o=this.productId,a=this.seriesId,s=this.searchName,c=this.todayOnline,u=this.warnDesc,l=this.groupId,d=this.currentPage,h=this.pageSize;r.getDeviceList(this,n,i,o,a,s,c,u,l,d,h).then((function(n){if("200"==n.code){var i=n.data,r=i.currentPage,o=i.data,a=i.total;if(!e.isShowNavScroll){e.isShowNavScroll=!0;var s=t.getStorageSync("navScrollHeight");s?(e.navScrollHeight=s,e.isShowList=!0):e.$nextTick((function(){setTimeout((function(){t.createSelectorQuery().in(e).select("#navScroll").boundingClientRect((function(n){var i=n.height;e.navScrollHeight=i,e.isShowList=!0,t.setStorageSync("navScrollHeight",i)})).exec()}),200)}))}for(var c=Math.ceil(a/h),u=[],l=1;l<=c;l++){var d=e.i18n.list.page,f=e.i18n.list.the;u.push("en"==e._i18n.locale?d+l:f+l+d)}e.productPageList=u,e.mescroll.endByPage(o.length,a);var p=e.$uniUtilsApi.initDeviceList(e.i18n.status,o),g=r-1;e.$set(e.deviceList,g,p),e.currentPageIndex=g,e.currentPage=r+1}}))},productStatusChange:function(t){var e=[null,"ONLINE","OFFLINE","UNACTIVE","DISABLE"],n=t.detail.value;this.currentStatusIndex=n,this.searchStatus=e[n],this.currentPage=1,this.deviceList=[],this.mescroll.scrollTo(0,300),this.mescroll.resetUpScroll()},typeSeriesColumnchange:function(t){var e=this,n=t.detail.column,i=t.detail.value;switch(n){case 0:if(0!=i){var r=this.productTypeData;this.productId=r[i].productId;var o=this.getProductSeriesList();o.then((function(t){var n=e.productSeriesList;e.productSeriesData;e.$set(e.productTypeSeriesListCopy,1,n),e.currentTypeSeriesIndexCopy=[i,0]}))}else this.$set(this.productTypeSeriesListCopy,1,this.i18n.list.productSeriesList),this.currentTypeSeriesIndexCopy=[0,0];break;default:break}this.$forceUpdate()},typeSeriesChange:function(t){var e=t.detail.value,n=this.productTypeData,i=this.productSeriesData;this.currentTypeSeriesIndex=e,this.currentTypeSeriesIndexCopy=e,this.productId=n[e[0]].productId,this.seriesId=i[e[1]].seriesId,this.productTypeSeriesList=l(this.productTypeSeriesListCopy),this.currentPage=1,this.deviceList=[],this.mescroll.scrollTo(0,300),this.mescroll.resetUpScroll()},productAlarmChange:function(t){var e,n,i=t.detail.value;this.currentAlarmIndex=i,0==i?(e=!1,n=!1):1==i?(e=!0,n=!1):2==i?(e=!1,n=!0):3==i&&(e=!0,n=!0),this.todayOnline=e,this.warnDesc=n,this.currentPage=1,this.deviceList=[],this.mescroll.scrollTo(0,300),this.mescroll.resetUpScroll()},productGroupChange:function(t){var e=t.detail.value;this.currentGroupIndex=e,this.groupId=this.productGroupData[e].groupId,this.currentPage=1,this.deviceList=[],this.mescroll.scrollTo(0,300),this.mescroll.resetUpScroll()},productPageChange:function(t){var e=t.detail.value;this.currentPageIndex=e,this.currentPage=parseInt(e)+1,this.deviceList=[],this.mescroll.scrollTo(0,300),this.mescroll.resetUpScroll()},searchNameInputChange:function(t){var e=t.detail.value.replace(/\s/g,"");""==e?this.deleteSearchName():(this.searchNameInput=e,this.isShowSearchButton=!0)},deleteSearchName:function(t){this.searchNameInput="",this.searchName=null,this.isShowSearchButton=!1,this.currentPage=1,this.deviceList=[],this.mescroll.scrollTo(0,300),this.mescroll.resetUpScroll()},tapSearchName:function(t){this.searchName=this.searchNameInput,this.isShowSearchButton=!1,this.currentPage=1,this.deviceList=[],this.mescroll.scrollTo(0,300),this.mescroll.resetUpScroll()},deviceNavigation:function(e,n,i){t.navigateTo({url:"/pages/deviceNavigation/deviceNavigation?deviceName=".concat(e,"&deviceCore=").concat(n,"&pageCur=").concat(i)})},areaList:function(e){t.navigateTo({url:"/pages/areaList/areaList"})},goToLogin:function(e){t.navigateTo({url:"/pages/login/login"})}},components:{listFav:y,surplus:S}};e.default=L}).call(this,n("543d")["default"])},7102:function(t,e,n){"use strict";n.r(e);var i=n("0e7b"),r=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=r.a},7829:function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}));var r=function(){var t=this,e=t.$createElement;t._self._c},o=[]},"90fe":function(t,e,n){"use strict";n.r(e);var i=n("afe2"),r=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=r.a},"9aa3":function(t,e,n){"use strict";var i=n("4d26"),r=n.n(i);r.a},"9d0b":function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}));var r=function(){var t=this,e=t.$createElement;t._self._c},o=[]},"9f41":function(t,e,n){},aa2d:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=c(n("a34a")),r=s(n("870a")),o=(s(n("1b64")),s(n("9bc8")));s(n("0db3")),c(n("8cdf"));function a(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function s(t){if(t&&t.__esModule)return t;if(null===t||"object"!==typeof t&&"function"!==typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=i?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=t[r]}return n.default=t,e&&e.set(t,n),n}function c(t){return t&&t.__esModule?t:{default:t}}function u(t,e,n,i,r,o,a){try{var s=t[o](a),c=s.value}catch(u){return void n(u)}s.done?e(c):Promise.resolve(c).then(i,r)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function a(t){u(o,i,r,a,s,"next",t)}function s(t){u(o,i,r,a,s,"throw",t)}a(void 0)}))}}var d={data:function(){return{isLogin:!1,isLoginOverdue:!1,userName:"",avatarUrl:"",deviceStatusList:[{},{},{},{}],deviceStatusNumberList:[0,0,0,0],currentMessageIndex:0,currentLanguageIndex:0,currentThemeIndex:0,openMessage:!1}},name:"centerComponent",computed:{i18n:function(){return this.$i18nMsg()},themei18n:function(){return this.$themei18nOption()}},mounted:function(){var e=t.getStorageSync("isLogin");this.isLogin=e,e?this.init():this.getUnLoginDeviceStatusCount()},methods:{init:function(){var e=l(i.default.mark((function e(){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.getDeviceStatusCount(),this.userName=t.getStorageSync("userName"),this.avatarUrl=t.getStorageSync("avatarUrl"),this.openMessage=t.getStorageSync("openMessage")||!1,this.currentMessageIndex=t.getStorageSync("messageIndex")||0,this.currentThemeIndex=t.getStorageSync("themeIndex")||0,this.currentLanguageIndex=t.getStorageSync("languageIndex")||0;case 7:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}(),goToLogin:function(e){t.navigateTo({url:"/pages/login/login"})},getUnLoginDeviceStatusCount:function(){for(var t=this.deviceStatusList,e=0;e<t.length;e++)this.$set(this.deviceStatusList,e,{num:"--",status:this.i18n.status[e]})},getDeviceStatusCount:function(){var t=this;o.getDeviceStatusCount(this).then((function(e){if("200"==e.code){for(var n=e.data,i=0;i<n.length;i++){var r=n[i].num;switch(n[i].status){case"ONLINE":t.$set(t.deviceStatusNumberList,0,r);break;case"OFFLINE":t.$set(t.deviceStatusNumberList,1,r);break;case"UNACTIVE":t.$set(t.deviceStatusNumberList,2,r);break;case"DISABLE":t.$set(t.deviceStatusNumberList,3,r);break;default:break}}var o=0,a=t.deviceStatusList,s=(t.deviceStatusNumberList,function e(){if(o<20)setTimeout((function(){for(var n=0;n<a.length;n++)t.$set(t.deviceStatusList,n,{num:0===t.deviceStatusNumberList[n]?0:o,status:t.i18n.status[n]});o++,e()}),10);else for(var n=0;n<a.length;n++)t.$set(t.deviceStatusList,n,{num:t.deviceStatusNumberList[n],status:t.i18n.status[n]})});s()}}))},tapCurrentVersion:function(){var t=this.i18n.currentVersion,e=wx.getStorageSync("browserVersion")||"1.1.21",n=this.i18n.confirm,i=this.i18n.cancel;this.$uniUtilsApi.showModal(t,e,!1,n,i,(function(t){}))},moreOperate:function(){t.navigateTo({url:"/pages/moreOperate/moreOperate"})},deviceNotice:function(){t.navigateTo({url:"/pages/deviceNotice/deviceNotice"})},tapScan:function(){this.$uniUtilsApi.handleScan(this)},deviceError:function(){t.navigateTo({url:"/pages/deviceError/deviceError"})},deviceStatus:function(){t.navigateTo({url:"/pages/deviceStatus/deviceStatus"})},moreSetting:function(){t.navigateTo({url:"/pages/moreSetting/moreSetting"})},pushMessage:function(){var e=!this.openMessage;if(e){var n=this.i18n.openMessage;this.$uniUtilsApi.bindUserSocket(n)}else{var i=this.i18n.closeMessage;this.$uniUtilsApi.unBindUserSocket(i)}this.openMessage=e,this.currentMessageIndex=e?1:0,t.setStorageSync("openMessage",e),t.setStorageSync("messageIndex",this.currentMessageIndex)},languagePickerChange:function(e){var n=this,i=this.isLogin,o=parseInt(e.detail.value),a=0==o?"zh":"en";if(i){var s=wx.getStorageSync("userId");r.updateLanguage(this,a,s).then((function(e){"200"==e.code&&(n.currentLanguageIndex=o,n.$i18n.locale=a,n.$emit("languageChange"),t.setStorageSync("language",a),t.setStorageSync("languageIndex",o),n.$uniUtilsApi.showToast(n.i18n.changeLanguage,"none",1e3,!1))}))}else this.$i18n.locale=a,this.$emit("languageChange"),this.$uniUtilsApi.showToast(this.i18n.changeLanguage,"none",1e3,!1)},themePickerChange:function(e){var n=this.isLogin;if(n){var i=e.detail.value,r=["default","darkColor","lightColor"],o=r[i];this.currentThemeIndex=i,this.$themei18n.locale=o,t.setStorageSync("theme",o),t.setStorageSync("themeIndex",i),this.$emit("themeChange"),this.$uniUtilsApi.showToast(this.i18n.changeTheme,"none",1e3,!1)}else this.unLogin()},tapLogout:function(){var e=this,n=this.i18n.moreSetting.logout,i=this.i18n.moreSetting.logoutContent,o=this.i18n.confirm,a=this.i18n.cancel;this.$uniUtilsApi.showModal(n,i,!0,o,a,(function(n){var i,o=t.getStorageSync("openid");i=r.loginOut(e,{openid:o,type:"wxAPP"}),i.then((function(n){if(n.status){t.removeStorageSync("openid"),t.removeStorageSync("nickName"),t.removeStorageSync("avatarUrl"),t.removeStorageSync("userId"),t.removeStorageSync("userName"),t.removeStorageSync("devKey"),t.removeStorageSync("accessToken"),t.removeStorageSync("singleLogin"),t.setStorageSync("isLogin",!1),e.isLogin=!1,e.$uniUtilsApi.showToast(e.i18n.logoutSuccess,"success",1e3,!1),e.$emit("unLogin"),e.getUnLoginDeviceStatusCount();var i=t.getStorageSync("openMessage")||!1;i&&e.$uniUtilsApi.unBindUserSocket(closeMessageTxt)}}))}),(function(t){}))},unLogin:function(){this.$uniUtilsApi.showToast(this.i18n.leadGotoLogin.unLogStatuTxt,"none",1e3,!1)},more:function(){this.$uniUtilsApi.showToast(this.i18n.noSupport,"none",1e3,!1)}}};e.default=d}).call(this,n("543d")["default"])},afe2:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=s(n("b060")),r=a(n("9bc8"));function o(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}function a(t){if(t&&t.__esModule)return t;if(null===t||"object"!==typeof t&&"function"!==typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var a=i?Object.getOwnPropertyDescriptor(t,r):null;a&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=t[r]}return n.default=t,e&&e.set(t,n),n}function s(t){return t&&t.__esModule?t:{default:t}}var c=function(){n.e("components/ztn-custom/surplus/surplus").then(function(){return resolve(n("617a"))}.bind(null,n)).catch(n.oe)},u=function(){n.e("components/ztn-custom/mapFav/mapFav").then(function(){return resolve(n("f53d"))}.bind(null,n)).catch(n.oe)},l={mixins:[i.default],data:function(){return{downOption:{use:!1,auto:!1},upOption:{empty:{use:!0,fixed:!0,top:"10%"}},CustomBar:this.CustomBar,isLogin:!0,isLoginOverdue:!1,scale:4.5,enlargeScale:!1,longitude:114.32452,latitude:27.099994,markers:[],markerId:Number,productId:null,status:null,currentPage:1,pageSize:10,currentStatusIndex:0,currentTypeIndex:0,productTypeList:[],productTypeData:[],deviceList:[],isShowDeviceList:!1,totalDeviceNum:0,hideIcon:"../../static/images/down.png",modalDeviceName:"",listTouchStart:0,listTouchDirection:null}},name:"mapComponent",computed:{i18n:function(){return this.$i18nMsg()}},mounted:function(){var e=t.getStorageSync("isLogin")||!1;this.isLogin=e,e&&this.init()},methods:{init:function(){this.getProductTypeList(),this.enlargeScale?this.getCityDeviceNum():this.getProvinceDeviceNum()},goToLogin:function(e){t.navigateTo({url:"/pages/login/login"})},getProductTypeList:function(){var e=this,n=t.getStorageSync("userId");r.getProductTypeList(this,n).then((function(t){if("200"==t.code){var n=t.data,i=e.$uniUtilsApi.handleProductType(e,n),r=i.productTypeList,o=i.productTypeData;e.productTypeList=r,e.productTypeData=o}}))},getProvinceDeviceNum:function(){var t=this;r.getProvinceDeviceNum(this).then((function(e){if("200"==e.code){var n=e.data;t.setMarkers(n)}}))},getCityDeviceNum:function(){var t=this;r.getCityDeviceNum(this).then((function(e){if("200"==e.code){var n=e.data;t.setMarkers(n)}}))},setMarkers:function(t){this.markers=[];for(var e=0;e<t.length;e++){var n={};n.id=Number(t[e].cityId?t[e].cityId:t[e].provinceId),n.width=25,n.height=25,n.latitude=Number(t[e].lat),n.longitude=Number(t[e].lng),t[e].num>=99?n.iconPath="../../static/numsImage/local_99.png":n.iconPath="../../static/numsImage/local_"+t[e].num+".png",this.$set(this.markers,e,n)}},markertap:function(t){this.markerId=t.detail.markerId,this.isShowDeviceList=!0,this.$emit("isShowNav",!1),this.currentPage=1},markerGetDeviceList:function(){var t=this,e=this.enlargeScale,n=e?null:this.markerId,i=e?this.markerId:null,o=this.productId,a=this.status,s=this.currentPage,c=this.pageSize;r.MarkerGetDeviceList(this,n,i,o,a,s,c).then((function(e){if("200"==e.code){var n=e.data,i=n.currentPage,r=n.data,o=n.total;t.totalDeviceNum=o,t.mescroll.endByPage(r.length,o);var a=i-1,s=t.$uniUtilsApi.initDeviceList(t.i18n.status,r);t.$set(t.deviceList,a,s),t.currentPage=i+1}}))},regionchange:function(){var e=this,n=new Promise((function(n){t.createMapContext("myMap",e).getScale({success:function(t){n(t)}})}));n.then((function(t){e.getDeviceNum(t)}))},getDeviceNum:function(t){var e=this.enlargeScale,n=t.scale;n<7&&e?(this.getProvinceDeviceNum(),this.enlargeScale=!1):n>=7&&!e&&(this.getCityDeviceNum(),this.enlargeScale=!0)},hideDeviceList:function(){this.isShowDeviceList=!1,this.$emit("isShowNav",!0),this.currentStatusIndex=0,this.currentTypeIndex=0,this.status=null,this.productId=null,this.currentPage=1,this.deviceList=[]},ListTouchStart:function(t){this.listTouchStart=t.touches[0].pageX},ListTouchMove:function(t){this.listTouchDirection=t.touches[0].pageX-this.listTouchStart>0?"right":"left"},ListTouchEnd:function(t){"left"==this.listTouchDirection?this.modalDeviceName=t.currentTarget.dataset.devicename:this.modalDeviceName=null,this.listTouchDirection=null},deviceNavigation:function(e,n,i){t.navigateTo({url:"/pages/deviceNavigation/deviceNavigation?deviceName=".concat(e,"&deviceCore=").concat(n,"&pageCur=").concat(i)})},navigation:function(e){var n=e.deviceLat,i=e.deviceLng,r=e.deviceName,o=e.deviceAddr;t.getLocation({type:"wgs84",success:function(e){t.openLocation({latitude:n,longitude:i,name:r,address:o,success:function(){}})}})},productStatusChange:function(t){var e=[null,"ONLINE","OFFLINE","UNACTIVE","DISABLE"],n=t.detail.value;this.currentStatusIndex=n,this.status=e[n],this.currentPage=1,this.deviceList=[],this.mescroll.resetUpScroll()},productTypeChange:function(t){var e=t.detail.value;this.currentTypeIndex=e,this.productId=this.productTypeData[e].productId,this.currentPage=1,this.deviceList=[],this.mescroll.resetUpScroll()}},components:{mapFav:u,surplus:c}};e.default=l}).call(this,n("543d")["default"])},c57a:function(t,e,n){"use strict";n.r(e);var i=n("aa2d"),r=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=r.a},c676:function(t,e,n){"use strict";(function(t){n("91b7"),n("921b");i(n("66fd"));var e=i(n("52c0"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},c75a:function(t,e,n){"use strict";n.r(e);var i=n("6cc7"),r=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=r.a},e289:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=c(n("9bc8")),r=c(n("0b74")),o=c(n("1b64")),a=c(n("5891"));function s(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function c(t){if(t&&t.__esModule)return t;if(null===t||"object"!==typeof t&&"function"!==typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=i?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=t[r]}return n.default=t,e&&e.set(t,n),n}var u={data:function(){return{CustomBar:this.CustomBar,customIcon:"cuIcon-add",customColor:"",isShowBindDeviceModal:!1,isLoginOverdue:!1,show:"cardSwiper",indicatorDots:!0,circular:!0,autoplay:!0,interval:5e3,duration:500,indicatorActiveColor:"#70c8e2",cardSwiperList:[],videoHeight:"",videoList:[],playUrl:"",productTypeList:[],currentPage:1,pageSize:10,cameraList:[],playIcon:"../../static/images/cam/play.png",pauseIcon:"../../static/images/cam/pause.png",deviceId:"",pushTime:60}},name:"homeComponent",props:{isLogin:{type:Boolean},tabbarHeight:{type:[Number,String],default:""}},watch:{isLogin:{immediate:!0,handler:function(t,e){t&&this.initResource()},deep:!0}},computed:{themei18n:function(){return this.$themei18nOption()},i18n:function(){return this.$i18nMsg()}},mounted:function(){this.init()},methods:{init:function(){var e=t.getStorageSync("companyId");this.getCardSwiperList(e),this.getVideoList(e),this.getCardSwiperHeight()},initResource:function(){this.getCameraList(),this.getProductTypeList()},getCardSwiperList:function(t){var e=this;a.getCompanyResource(this,"phoneSlideshow",t).then((function(t){if("200"==t.code){for(var n=t.data,i=[],r=0;r<n.length;r++){var o={},a=n[r],s=a.type,c=a.url;o.id=r,o.type=s,o.url=c,i.push(o)}e.cardSwiperList=i}}))},getCardSwiperHeight:function(){var e=this,n=t.getStorageSync("videoHeight");n?this.videoHeight=n:t.createSelectorQuery().in(this).select("#cardSwiper").boundingClientRect((function(n){e.videoHeight=n.height,t.setStorageSync("videoHeight",n.height)})).exec()},cardSwiperChange:function(t){this.cardCur=t.detail.current},getVideoList:function(t){var e=this;a.getCompanyResource(this,"video",t).then((function(t){if("200"==t.code){for(var n=t.data,i=[],r=0;r<n.length;r++){var o={},a=n[r],s=a.iconUrl,c=a.url,u=a.title;o.iconUrl=s,o.url=c,o.title=u,i.push(o)}e.videoList=i}}))},tapVideo:function(t){this.show="agricultureVideo",this.playUrl=t.url},closeVideo:function(t){this.show="cardSwiper",this.playUrl="",this.stopCloud(),this.deviceId=""},getCameraList:function(){var e=this,n=t.getStorageSync("userId"),i=this.currentPage,o=this.pageSize,a=[];r.getCameraDeviceList(this,n,i,o).then((function(t){if("200"==t.code){var n=t.data,r=n.data,o=n.total;if(o<1)return void(e.cameraList=[]);for(var s=0;s<r.length;s++){var c={},u=r[s],l=u.picturePath,d=u.deviceId,h=u.hid;c.picturePath=l&&"".concat(l),c.deviceId=d,c.hid=h,a.push(c)}1==i&&a.length>3?e.cameraList=a.slice(1,5):e.cameraList=a,e.currentPage=i+1}}))},tapCamera:function(e){var n=this;this.show="cameraVideo",this.playUrl="",this.stopCloud();var i=e.deviceId;this.deviceId=i;var o=this.pushTime;r.pushCloud(this,i,o).then((function(e){if("200"==e.code){var i=e.data.playUrl;if(null!=i){var r=e.data.mediaType;n.playUrl=i,n.videoType="m3u8"==r||"httpflv"==r?r:"rtmp"}else n.$uniUtilsApi.showToast(n.i18n.invalidAddress,"none",1e3,!1)}else{if("201"==e.code)switch(e.msg){case"serverCompany":n.$uniUtilsApi.showToast(n.i18n.camera.equipmentNotSupported,"none",1e3,!1);break;case"OFFLINE":n.$uniUtilsApi.showToast(n.i18n.camera.equipmentOffline,"none",1e3,!1);break;default:n.$uniUtilsApi.showToast(n.i18n.camera.pushFailure,"none",1e3,!1);break}else n.$uniUtilsApi.showToast(n.i18n.camera.pushFailure,"none",1e3,!1);setTimeout((function(){t.navigateBack()}),1e3)}}))},stopCloud:function(){var t=this.deviceId;t&&r.stopCloud(this,t).then((function(t){t.code}))},deviceCamera:function(){t.navigateTo({url:"/pages/deviceCamera/deviceCamera"})},getProductTypeList:function(){var e=this,n=t.getStorageSync("userId");i.getProductTypeList(this,n).then((function(t){if("200"==t.code){var n=t.data,i=e.themei18n.standardColor,r=[];for(var o in i){if("grey"==o)break;r.push(i[o])}for(var a=0,s=r.length,c=0;c<n.length;c++)a<s?(n[c].color=r[a],a+=1):(n[c].color=r[0],a=1);e.productTypeList=n}}))},list:function(t){var e={pageCur:"list",productId:t.productId};this.$emit("list",e)},bindDeviceModal:function(){this.isShowBindDeviceModal=!this.isShowBindDeviceModal},bindDevice:function(t){var e=this,n=t.detail.value.deviceCore.replace(/\s/g,"");this.isShowBindDeviceModal=!1,o.getDeviceInfo(this,n).then((function(t){"200"==t.code?e.$uniUtilsApi.showToast(e.i18n.bindSuccess,"none",1e3,!1):e.$uniUtilsApi.showToast(e.i18n.bindFail,"none",1e3,!1)}))}}};e.default=u}).call(this,n("543d")["default"])},f715:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}));var i={mescrollUni:function(){return Promise.all([n.e("common/vendor"),n.e("components/mescroll-uni/mescroll-uni")]).then(n.bind(null,"1387"))}},r=function(){var t=this,e=t.$createElement;t._self._c},o=[]}},[["c676","common/runtime","common/vendor"]]]);