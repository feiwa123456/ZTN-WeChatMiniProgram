(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"32e3":function(e,n,t){},"3c52":function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=s(t("870a")),o=s(t("0db3"));s(t("5891"));function a(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function s(e){if(e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var n=a();if(n&&n.has(e))return n.get(e);var t={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(t,o,s):t[o]=e[o]}return t.default=e,n&&n.set(e,t),t}var r={data:function(){return{isToHome:!1,openid:"",companyName:"",iconUrl:"",userName:"",password:"",focusPasswordInput:!1,attention:!1,enableRegister:!1}},computed:{i18n:function(){return this.$i18nMsg()}},onLoad:function(){this.getCompanyInfo()},onShow:function(){this.$uniUtilsApi.toHome(this)},methods:{getCompanyInfo:function(){var e=this,n=this.$uniUtilsApi.getCompanyInfo(this);n.then((function(){e.init()}))},init:function(){var n=e.getStorageSync("openid"),t=e.getStorageSync("iconUrl"),i=e.getStorageSync("shortCompanyName"),o=e.getStorageSync("enableRegister");this.iconUrl=t,this.companyName=i,this.enableRegister=o,n?(this.openid=n,this.useOpenidLogin()):this.WEIXINGetOpenid()},WEIXINGetOpenid:function(){var n=this,t=e.getStorageSync("companyId");wx.login({success:function(o){i.WEIXINGetOpenid(n,o.code,t).then((function(t){n.openid=t.data.openid,e.setStorageSync("openid",n.openid),n.useOpenidLogin()}))},fail:function(e){n.$uniUtilsApi.showToast(n.i18n.login.userInfoFail,"none",1e3,!1)}})},H5GetOpenid:function(){var n=window.location.href,t=n.split("?")[1];if(t){var i=new URLSearchParams(t);i&&"singlemessage"==i.get("from")&&(this.openid=i.get("openid"),e.setStorageSync("openid",this.openid),this.useOpenidLogin())}},changeUserNameInput:function(e){this.password;var n=e.detail.value.replace(/\s/g,"");this.userName=n},cleanUserName:function(){this.userName=""},changePasswordInput:function(e){this.userName;var n=e.detail.value.replace(/\s/g,"");this.password=n},changeAttention:function(){this.attention=!this.attention,this.focusPasswordInput=!0},userForgetpsw:function(){this.$uniUtilsApi.showToast(this.i18n.noSupport,"none",1e3,!1)},useOpenidLogin:function(n,t){var i=this,a=this.openid,s=e.getStorageSync("companyId");n=n||o.userLogin(this,{companyId:s,openid:a,getType:"wxApp"});n.then((function(n){if(n.status){var o=getCurrentPages(),a=o[o.length-2];switch(n.code){case"200":var s=n.data,r=s.userId,u=s.userName,c=s.devKey,g=s.accessToken,l=s.singleLogin,d=s.language,f=!0,p="zh"==d?0:1;e.setStorageSync("userId",r),e.setStorageSync("userName",u),e.setStorageSync("devKey",c),e.setStorageSync("accessToken",g),e.setStorageSync("singleLogin",l),e.setStorageSync("language",d),e.setStorageSync("languageIndex",p),e.setStorageSync("isLogin",f),i.$uniUtilsApi.showToast(i.i18n.bindSuccess,"none",1e3,!1),a?(a.$vm.fromLoginBack=!0,e.navigateBack()):e.navigateTo({url:"/pages/nav/nav"});break;case"201":"H5Bind"==t?i.$uniUtilsApi.showToast(i.i18n.login.noExistUser,"none",1e3,!1):i.$uniUtilsApi.showToast(i.i18n.login.bindUser,"none",1e3,!1);d=e.getStorageSync("language");!a&&(i.$i18n.locale=d);break;default:break}}}))},usePswLogin:function(n){var t=this,o=this.userName,a=this.$md5(this.password),s=this.openid,r=e.getStorageSync("companyId");if(null!=n.detail.userInfo){var u=n.detail.userInfo,c=u.avatarUrl,g=u.nickName,l=i.WEIXINUsePswBindUser(this,r,o,a,c,g,s);l.then((function(n){if(e.setStorageSync("nickName",g),e.setStorageSync("avatarUrl",c),n.status)"200"==n.code?(t.$uniUtilsApi.showToast(t.i18n.bindSuccess,"none",1e3,!1),t.useOpenidLogin()):t.$uniUtilsApi.showToast(t.i18n.login.noExistUser,"none",1e3,!1);else if("202"==n.code){var i=getCurrentPages();void 0!=i[i.length-2]?e.navigateBack():e.navigateTo({url:"/pages/nav/nav"})}else t.$uniUtilsApi.showToast(t.i18n.login.noExistUser,"none",1e3,!1)}))}},userExperience:function(n){var t=this,o=e.getStorageSync("companyId");if(null!=n.detail.userInfo){var a=this.openid,s=n.detail.userInfo,r=s.avatarUrl,u=s.nickName,c=i.userExperience(this,{companyId:o,openid:a,isDemoAccount:!0,nickName:u,headimgurl:r,type:"wxApp"});c.then((function(n){"200"==n.code?(e.setStorageSync("nickName",u),e.setStorageSync("avatarUrl",r),t.$uniUtilsApi.showToast(t.i18n.bindSuccess,"none",1e3,!1),t.useOpenidLogin()):t.$uniUtilsApi.showToast(t.i18n.login.noExistUser,"none",1e3,!1)}))}},userRegister:function(){e.navigateTo({url:"/pages/register/register"})}}};n.default=r}).call(this,t("543d")["default"])},5948:function(e,n,t){"use strict";(function(e){t("91b7"),t("921b");i(t("66fd"));var n=i(t("f303"));function i(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])},6317:function(e,n,t){"use strict";var i;t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return i}));var o=function(){var e=this,n=e.$createElement;e._self._c},a=[]},c6d3:function(e,n,t){"use strict";var i=t("32e3"),o=t.n(i);o.a},ef0a:function(e,n,t){"use strict";t.r(n);var i=t("3c52"),o=t.n(i);for(var a in i)"default"!==a&&function(e){t.d(n,e,(function(){return i[e]}))}(a);n["default"]=o.a},f303:function(e,n,t){"use strict";t.r(n);var i=t("6317"),o=t("ef0a");for(var a in o)"default"!==a&&function(e){t.d(n,e,(function(){return o[e]}))}(a);t("c6d3");var s,r=t("f0c5"),u=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"4b9227ab",null,!1,i["a"],s);n["default"]=u.exports}},[["5948","common/runtime","common/vendor"]]]);